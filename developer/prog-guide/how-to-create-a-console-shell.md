---
title: Come creare una Shell Console | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Make-Shell [PowerShell Programmer's Guide]
ms.assetid: 6c24dd44-a8ec-421d-ac86-90912e1a8cc6
caps.latest.revision: 5
ms.openlocfilehash: 7166881bd1403ea8c81ec2928321f6b93e3ac58d
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/03/2019
ms.locfileid: "56853497"
---
# <a name="how-to-create-a-console-shell"></a><span data-ttu-id="556da-102">Come creare una shell di console</span><span class="sxs-lookup"><span data-stu-id="556da-102">How to Create a Console Shell</span></span>

<span data-ttu-id="556da-103">Windows PowerShell fornisce uno strumento Shell marca, noto anche come il "marca-kit", che viene usato per creare una shell di console che non è estendibile.</span><span class="sxs-lookup"><span data-stu-id="556da-103">Windows PowerShell provides a Make-Shell tool, also referred to as the "make-kit", that is used to create a console shell that is not extensible.</span></span> <span data-ttu-id="556da-104">Shell creata con questo nuovo strumento non può essere esteso in un secondo momento tramite uno snap-in Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="556da-104">Shells created with this new tool cannot be extended later through a Windows PowerShell snap-in.</span></span>

## <a name="syntax"></a><span data-ttu-id="556da-105">Sintassi</span><span class="sxs-lookup"><span data-stu-id="556da-105">Syntax</span></span>

<span data-ttu-id="556da-106">Di seguito è riportata la sintassi usata per eseguire la Shell di marca all'interno di un file di creazione.</span><span class="sxs-lookup"><span data-stu-id="556da-106">Here is the syntax used to run Make-Shell from within a make-file.</span></span>

```
make-shell
  -out n.exe
  -namespace ns
  [ -lib libdirectory1[,libdirectory2,..] ]
  [ -reference ca1.dll[,ca2.dll,...] ]
  [ -formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...] ]
  [ -typedata td1.type.ps1xml[,td2.type.ps1xml,...] ]
  [ -source c1.cs [,c2.cs,...] ]
  [ -authorizationmanager authorizationManagerType ]
  [ -win32icon i.ico ]
  [ -initscript p.ps1 ]
  [ -builtinscript s1.ps1[,s2.ps1,...] ]
  [ -resource resourcefile.txt ]
  [ -cscflags cscFlags ]
  [ -? | -help ]
```

## <a name="parameters"></a><span data-ttu-id="556da-107">Parametri</span><span class="sxs-lookup"><span data-stu-id="556da-107">Parameters</span></span>

<span data-ttu-id="556da-108">Ecco una breve descrizione dei parametri della marca-Shell.</span><span class="sxs-lookup"><span data-stu-id="556da-108">Here is a brief description of the parameters of Make-Shell.</span></span>

> [!CAUTION]
> <span data-ttu-id="556da-109">Percorsi UNC delle assembly non sono supportati dalla marca-Shell.</span><span class="sxs-lookup"><span data-stu-id="556da-109">UNC paths to assemblies are not supported by Make-Shell.</span></span>

|<span data-ttu-id="556da-110">Parametro</span><span class="sxs-lookup"><span data-stu-id="556da-110">Parameter</span></span>|<span data-ttu-id="556da-111">Description</span><span class="sxs-lookup"><span data-stu-id="556da-111">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="556da-112">-out n.exe</span><span class="sxs-lookup"><span data-stu-id="556da-112">-out n.exe</span></span>|<span data-ttu-id="556da-113">Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="556da-113">Required.</span></span> <span data-ttu-id="556da-114">Il nome della shell per produrre.</span><span class="sxs-lookup"><span data-stu-id="556da-114">The name of the shell to produce.</span></span> <span data-ttu-id="556da-115">Il percorso è specificato come parte di questo parametro.</span><span class="sxs-lookup"><span data-stu-id="556da-115">The path is specified as part of this parameter.</span></span><br /><br /> <span data-ttu-id="556da-116">Marca shell aggiungerà ".exe" questo valore se non è specificato.</span><span class="sxs-lookup"><span data-stu-id="556da-116">Make-shell will append ".exe" to this value if it is not specified.</span></span> <span data-ttu-id="556da-117">**Attenzione:**  Non creare un file di output con lo stesso nome del file DLL di cui viene fatto riferimento.</span><span class="sxs-lookup"><span data-stu-id="556da-117">**Caution:**  Do not create an output file with the same name as the referenced .dll file.</span></span> <span data-ttu-id="556da-118">Se si tenta di ciò, lo strumento marca Shell crea un file con estensione cs con lo stesso nome, che sovrascriverà il file con estensione cs che contiene il codice sorgente di cmdlet.</span><span class="sxs-lookup"><span data-stu-id="556da-118">If you attempt this, the Make-Shell tool creates a .cs file with the same name, which will overwrite the .cs file that has your cmdlet source code.</span></span>|
|<span data-ttu-id="556da-119">-spazio dei nomi ns</span><span class="sxs-lookup"><span data-stu-id="556da-119">-namespace ns</span></span>|<span data-ttu-id="556da-120">Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="556da-120">Required.</span></span> <span data-ttu-id="556da-121">Lo spazio dei nomi da utilizzare per derivato [System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) classe che il kit di assicurarsi che genera l'errore e viene compilato.</span><span class="sxs-lookup"><span data-stu-id="556da-121">The namespace to use for the derived [System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) class that the make-kit generates and compiles.</span></span>|
|<span data-ttu-id="556da-122">-lib libdirectory1 [, libdirectory2,..]</span><span class="sxs-lookup"><span data-stu-id="556da-122">-lib libdirectory1[,libdirectory2,..]</span></span>|<span data-ttu-id="556da-123">Le directory in cui vengono cercate gli assembly .NET, inclusi gli assembly di Windows PowerShell, assembly specificati per il `reference` parametro, gli assembly di riferimento indiretto da un altro assembly e gli assembly di sistema di .NET.</span><span class="sxs-lookup"><span data-stu-id="556da-123">The directories that are searched for .NET assemblies, including the Windows PowerShell assemblies, assemblies specified by the `reference` parameter, assemblies indirectly referenced by another assembly, and the .NET system assemblies.</span></span>|
|<span data-ttu-id="556da-124">-riferimento ca1.dll[,ca2.dll,...]</span><span class="sxs-lookup"><span data-stu-id="556da-124">-reference ca1.dll[,ca2.dll,...]</span></span>|<span data-ttu-id="556da-125">Elenco delimitato da virgole degli assembly da includere nella shell.</span><span class="sxs-lookup"><span data-stu-id="556da-125">A comma-separated list of the assemblies to include in the shell.</span></span> <span data-ttu-id="556da-126">Questi assembly include tutti i cmdlet e gli assembly del provider, nonché gli assembly di risorse che devono essere caricati.</span><span class="sxs-lookup"><span data-stu-id="556da-126">These assemblies  includes all cmdlet and provider assemblies, as well as resource assemblies that should be loaded.</span></span> <span data-ttu-id="556da-127">Se questo parametro viene omesso, una shell viene prodotto che contiene solo i cmdlet e provider principali fornite da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="556da-127">If this parameter is not specified, then a shell is produced that contains only the core cmdlets and providers provided by Windows PowerShell.</span></span><br /><br /> <span data-ttu-id="556da-128">L'assembly può essere specificato usando il percorso completo, in caso contrario, essi verrà cercati utilizzando il percorso specificato da di `lib` parametro.</span><span class="sxs-lookup"><span data-stu-id="556da-128">The assemblies can be specified using their full path, otherwise they will be searched for using the path specified by the `lib` parameter.</span></span>|
|<span data-ttu-id="556da-129">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="556da-129">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span></span>|<span data-ttu-id="556da-130">Elenco delimitato da virgole di formattare i dati da includere nella shell.</span><span class="sxs-lookup"><span data-stu-id="556da-130">A comma-separated list of format data to include in the shell.</span></span> <span data-ttu-id="556da-131">Se questo parametro viene omesso, una shell viene prodotto che contiene solo i dati di formato forniti da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="556da-131">If this parameter is not specified, then a shell is produced that contains only the format data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="556da-132">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="556da-132">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span></span>|<span data-ttu-id="556da-133">Elenco delimitato da virgole di dati di tipo da includere nella shell.</span><span class="sxs-lookup"><span data-stu-id="556da-133">A comma-separated list of type data to include in the shell.</span></span> <span data-ttu-id="556da-134">Se questo parametro viene omesso, una shell viene prodotto che contiene solo i dati di tipo forniti da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="556da-134">If this parameter is not specified, then a shell is produced that contains only the type data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="556da-135">-origine c1.cs [, c2.cs,...]</span><span class="sxs-lookup"><span data-stu-id="556da-135">-source c1.cs [,c2.cs,...]</span></span>|<span data-ttu-id="556da-136">Il nome di un file, fornito dallo sviluppatore di shell, che contiene tutto il codice sorgente necessario per compilare la shell.</span><span class="sxs-lookup"><span data-stu-id="556da-136">The name of a file, provided by the shell developer, that contains any source code needed to build the shell.</span></span><br /><br /> <span data-ttu-id="556da-137">File del codice sorgente può contenere il codice sorgente seguente:</span><span class="sxs-lookup"><span data-stu-id="556da-137">The source code file can contain any of the following source code:</span></span><br /><br /> <span data-ttu-id="556da-138">-L'implementazione di gestione di autorizzazione che esegue l'override di gestione di autorizzazioni predefinito.</span><span class="sxs-lookup"><span data-stu-id="556da-138">-   The Authorization manager implementation that overrides the default authorization manager.</span></span> <span data-ttu-id="556da-139">(Questo è stato necessario fornire anche compilato in un assembly.)</span><span class="sxs-lookup"><span data-stu-id="556da-139">(This could also be supplied compiled into an assembly.)</span></span><br /><span data-ttu-id="556da-140">Dichiarazioni di attributi informativi assembly: ad esempio il AssemblyCompanyAttribute AssemblyCopyrightAttribute, AssemblyFileVersionAttribute, AssemblyInformationalVersionAttribute, AssemblyProductAttribute, e AssemblyTrademarkAttribute.</span><span class="sxs-lookup"><span data-stu-id="556da-140">-   Assembly informational attribute declarations: such as the AssemblyCompanyAttribute, AssemblyCopyrightAttribute, AssemblyFileVersionAttribute, AssemblyInformationalVersionAttribute, AssemblyProductAttribute, and AssemblyTrademarkAttribute.</span></span>|
|<span data-ttu-id="556da-141">Gestione autorizzazioni - authorizationManagerType</span><span class="sxs-lookup"><span data-stu-id="556da-141">-authorizationmanager authorizationManagerType</span></span>|<span data-ttu-id="556da-142">Tipo che contiene l'implementazione del gestore di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="556da-142">The type that contains the authorization manager implementation.</span></span> <span data-ttu-id="556da-143">Questo può essere definito nel codice sorgente o compilato in un assembly (specificato da di `reference` parametro).</span><span class="sxs-lookup"><span data-stu-id="556da-143">This can be defined in source code, or compiled into an assembly (specified by the `reference` parameter).</span></span> <span data-ttu-id="556da-144">Se questo parametro viene omesso, viene utilizzato il gestore di sicurezza predefinito.</span><span class="sxs-lookup"><span data-stu-id="556da-144">If this parameter is not specified, the default security manager is used.</span></span> <span data-ttu-id="556da-145">Il valore deve essere il nome completo del tipo, inclusi gli spazi dei nomi.</span><span class="sxs-lookup"><span data-stu-id="556da-145">The value should be the full type name, including namespaces.</span></span>|
|<span data-ttu-id="556da-146">-win32icon i.ico</span><span class="sxs-lookup"><span data-stu-id="556da-146">-win32icon i.ico</span></span>|<span data-ttu-id="556da-147">Icona per il file .exe della shell.</span><span class="sxs-lookup"><span data-stu-id="556da-147">The icon for the .exe file for the shell.</span></span> <span data-ttu-id="556da-148">Se non specificato, la shell avrà l'icona che il compilatore c# include (se presente).</span><span class="sxs-lookup"><span data-stu-id="556da-148">If not specified, then the shell will have the icon that the c# compiler includes (if any).</span></span>|
|<span data-ttu-id="556da-149">-initscript p.ps1</span><span class="sxs-lookup"><span data-stu-id="556da-149">-initscript p.ps1</span></span>|<span data-ttu-id="556da-150">Il profilo di avvio della shell.</span><span class="sxs-lookup"><span data-stu-id="556da-150">The startup profile for the shell.</span></span> <span data-ttu-id="556da-151">Il file viene fornito "come-è"; viene eseguito alcun controllo di validità dalla marca-Shell.</span><span class="sxs-lookup"><span data-stu-id="556da-151">The file is included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="556da-152">-s1.ps1[,s2.ps1 builtinscript,...]</span><span class="sxs-lookup"><span data-stu-id="556da-152">-builtinscript s1.ps1[,s2.ps1,...]</span></span>|<span data-ttu-id="556da-153">Un elenco di script incorporato per la shell.</span><span class="sxs-lookup"><span data-stu-id="556da-153">A list of built-in scripts for the shell.</span></span> <span data-ttu-id="556da-154">Questi script vengono individuati prima gli script nel percorso e il relativo contenuto non può essere modificato dopo aver compilata la shell.</span><span class="sxs-lookup"><span data-stu-id="556da-154">These scripts are discovered before scripts in the path, and their contents cannot be changed once the shell is built.</span></span><br /><br /> <span data-ttu-id="556da-155">I file sono inclusi "come-è"; viene eseguito alcun controllo di validità dalla marca-Shell.</span><span class="sxs-lookup"><span data-stu-id="556da-155">The files are included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="556da-156">-risorse resourcefile.txt</span><span class="sxs-lookup"><span data-stu-id="556da-156">-resource resourcefile.txt</span></span>|<span data-ttu-id="556da-157">Il file con estensione txt contenente della Guida in linea e banner delle risorse per la shell.</span><span class="sxs-lookup"><span data-stu-id="556da-157">The .txt file containing help and banner resources for the shell.</span></span> <span data-ttu-id="556da-158">La prima risorsa denominata ShellHelp e contiene il testo visualizzato se la shell viene richiamata con il `help` parametro.</span><span class="sxs-lookup"><span data-stu-id="556da-158">The first resource is named ShellHelp, and contains the text displayed if the shell is invoked with the `help` parameter.</span></span> <span data-ttu-id="556da-159">La seconda risorsa denominata ShellBanner e contiene il testo e le informazioni sul copyright visualizzate quando la shell viene avviata in modalità interattiva.</span><span class="sxs-lookup"><span data-stu-id="556da-159">The second resource is named ShellBanner, and it contains the text and copyright information displayed when the shell is launched in interactive mode.</span></span><br /><br /> <span data-ttu-id="556da-160">Se non viene specificato questo parametro o queste risorse non sono presenti, vengono utilizzati un generico della Guida in linea e banner.</span><span class="sxs-lookup"><span data-stu-id="556da-160">If this parameter is not provided, or these resources are not present, then a generic help and banner are used.</span></span>|
|<span data-ttu-id="556da-161">-cscflags cscFlags</span><span class="sxs-lookup"><span data-stu-id="556da-161">-cscflags cscFlags</span></span>|<span data-ttu-id="556da-162">Flag da passare per il C# compilatore (csc.exe).</span><span class="sxs-lookup"><span data-stu-id="556da-162">Flags that should be passed to the C# compiler (csc.exe).</span></span> <span data-ttu-id="556da-163">Questi vengono passati invariati.</span><span class="sxs-lookup"><span data-stu-id="556da-163">These are passed through unchanged.</span></span> <span data-ttu-id="556da-164">Se questo parametro include spazi, deve essere racchiuso tra virgolette doppie.</span><span class="sxs-lookup"><span data-stu-id="556da-164">If this parameter includes spaces, it should be surrounded in double-quotes.</span></span>|
|<span data-ttu-id="556da-165">-?</span><span class="sxs-lookup"><span data-stu-id="556da-165">-?</span></span><br /><br /> <span data-ttu-id="556da-166">-Guida in linea</span><span class="sxs-lookup"><span data-stu-id="556da-166">-help</span></span>|<span data-ttu-id="556da-167">Visualizza il messaggio di copyright e opzioni della riga di comando verificare-Shell.</span><span class="sxs-lookup"><span data-stu-id="556da-167">Displays the copyright message and Make-Shell command line options.</span></span>|
|<span data-ttu-id="556da-168">-verbose</span><span class="sxs-lookup"><span data-stu-id="556da-168">-verbose</span></span>|<span data-ttu-id="556da-169">Visualizza informazioni dettagliate durante la creazione della shell.</span><span class="sxs-lookup"><span data-stu-id="556da-169">Displays detailed information while the shell is being created.</span></span>|

## <a name="see-also"></a><span data-ttu-id="556da-170">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="556da-170">See Also</span></span>

[<span data-ttu-id="556da-171">Guida per programmatori di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="556da-171">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="556da-172">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="556da-172">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)