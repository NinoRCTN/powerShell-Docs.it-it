---
title: Creazione di un Provider di navigazione di Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- navigation providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], navigation provider
ms.assetid: 8bd3224d-ca6f-4640-9464-cb4d9f4e13b1
caps.latest.revision: 5
ms.openlocfilehash: 40454f880b57d5b3a8a8ded21c8c97aebba027fe
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2019
ms.locfileid: "62081853"
---
# <a name="creating-a-windows-powershell-navigation-provider"></a><span data-ttu-id="f5ea7-102">Creazione di un provider di navigazione di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-102">Creating a Windows PowerShell Navigation Provider</span></span>

<span data-ttu-id="f5ea7-103">In questo argomento viene descritto come creare un provider di navigazione di Windows PowerShell che può passare l'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-103">This topic describes how to create a Windows PowerShell navigation provider that can navigate the data store.</span></span> <span data-ttu-id="f5ea7-104">Questo tipo di provider supporta comandi ricorsiva, i contenitori nidificati e i percorsi relativi.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-104">This type of provider supports recursive commands, nested containers, and relative paths.</span></span>

> [!NOTE]
> <span data-ttu-id="f5ea7-105">È possibile scaricare il C# file di origine (AccessDBSampleProvider05.cs) per questo provider tramite il Microsoft Windows Software Development Kit per Windows Vista e i componenti di Runtime di .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-105">You can download the C# source file (AccessDBSampleProvider05.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="f5ea7-106">Per istruzioni sul download, vedere [come installare Windows PowerShell e il Download di Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-106">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="f5ea7-107">Sono disponibili in file di origine scaricato il  **\<esempi di PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-107">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="f5ea7-108">Per altre informazioni sulle altre implementazioni del provider di Windows PowerShell, vedere [la progettazione del Provider di Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-108">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="f5ea7-109">Il provider descritto di seguito consente l'handle dell'utente un database di Access come un'unità in modo che l'utente possa passare alle tabelle di dati nel database.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-109">The provider described here enables the user handle an Access database as a drive so that the user can navigate to the data tables in the database.</span></span> <span data-ttu-id="f5ea7-110">Quando si crea un proprio provider di navigazione, è possibile implementare i metodi che possono rendere drivequalified percorsi necessari per la navigazione, normalizzare i percorsi relativi, spostare gli elementi dell'archivio dati, nonché i metodi che ottenere i nomi di figlio e ottenere il percorso padre di un elemento di test per identificare se un elemento è un contenitore.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-110">When creating your own navigation provider, you can implement methods that can make drive-qualified paths required for navigation, normalize relative paths, move items of the data store, as well as methods that get child names, get the parent path of an item, and test to identify if an item is a container.</span></span>

> [!CAUTION]
> <span data-ttu-id="f5ea7-111">Tenere presente che questa progettazione si presuppone che un database con un campo con l'ID del nome e che il tipo del campo è LongInteger.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-111">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="f5ea7-112">Nell'elenco seguente include le sezioni in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-112">The following list includes sections in this topic.</span></span> <span data-ttu-id="f5ea7-113">Se non si ha familiarità con la scrittura di un provider di navigazione di Windows PowerShell, leggere queste informazioni nell'ordine in cui viene visualizzato.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-113">If you are unfamiliar with writing a Windows PowerShell navigation provider, read this information in the order that it appears.</span></span> <span data-ttu-id="f5ea7-114">Tuttavia, se si ha familiarità con la scrittura di un provider di navigazione di Windows PowerShell, passare direttamente alle informazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-114">However, if you are familiar with writing a Windows PowerShell navigation provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="f5ea7-115">Definizione di una classe di Provider di navigazione di PS</span><span class="sxs-lookup"><span data-stu-id="f5ea7-115">Defining a PS Navigation Provider Class</span></span>](#Define-the-Windows-PowerShell-provider)

- [<span data-ttu-id="f5ea7-116">Definizione funzionalità di Base</span><span class="sxs-lookup"><span data-stu-id="f5ea7-116">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="f5ea7-117">Creazione di un percorso di PS</span><span class="sxs-lookup"><span data-stu-id="f5ea7-117">Creating a PS Path</span></span>](#Creating-a-Windows-PowerShell-Path)

- [<span data-ttu-id="f5ea7-118">Recupero del percorso dell'elemento padre</span><span class="sxs-lookup"><span data-stu-id="f5ea7-118">Retrieving the Parent Path</span></span>](#Retrieving-the-Parent-Path)

- [<span data-ttu-id="f5ea7-119">Impossibile recuperare il nome di percorso figlio</span><span class="sxs-lookup"><span data-stu-id="f5ea7-119">Retrieving the Child Path Name</span></span>](#Retrieve-the-Child-Path-Name)

- [<span data-ttu-id="f5ea7-120">Determinare se un elemento è un contenitore</span><span class="sxs-lookup"><span data-stu-id="f5ea7-120">Determining if an Item is a Container</span></span>](#Determining-if-an-Item-is-a-Container)

- [<span data-ttu-id="f5ea7-121">Spostamento di un elemento</span><span class="sxs-lookup"><span data-stu-id="f5ea7-121">Moving an Item</span></span>](#Moving-an-Item)

- [<span data-ttu-id="f5ea7-122">Associare i parametri dinamici al `Move-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="f5ea7-122">Attaching Dynamic Parameters to the `Move-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Move-Item-Cmdlet)

- [<span data-ttu-id="f5ea7-123">Normalizzazione di un percorso relativo</span><span class="sxs-lookup"><span data-stu-id="f5ea7-123">Normalizing a Relative Path</span></span>](#Normalizing-a-Relative-Path)

- [<span data-ttu-id="f5ea7-124">Esempio di codice</span><span class="sxs-lookup"><span data-stu-id="f5ea7-124">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="f5ea7-125">Definizione di tipi di oggetto e formattazione</span><span class="sxs-lookup"><span data-stu-id="f5ea7-125">Defining Object Types and Formatting</span></span>](#Defining-Object-Types-and-Formatting)

- [<span data-ttu-id="f5ea7-126">Creazione del Provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-126">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

- [<span data-ttu-id="f5ea7-127">Test di un Provider Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-127">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-provider)

## <a name="define-the-windows-powershell-provider"></a><span data-ttu-id="f5ea7-128">Definire il provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-128">Define the Windows PowerShell provider</span></span>

<span data-ttu-id="f5ea7-129">Un provider di navigazione di Windows PowerShell è necessario creare una classe .NET che deriva dal [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) classe di base.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-129">A Windows PowerShell navigation provider must create a .NET class that derives from the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class.</span></span> <span data-ttu-id="f5ea7-130">Ecco la definizione di classe per il provider di spostamento descritte in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-130">Here is the class definition for the navigation provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L31-L32 "AccessDBProviderSample05.cs")]

<span data-ttu-id="f5ea7-131">Si noti che questo provider, il [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attributo include due parametri.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-131">Note that in this provider, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="f5ea7-132">Il primo parametro specifica un nome descrittivo per il provider usato da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-132">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="f5ea7-133">Il secondo parametro specifica le funzionalità specifiche di Windows PowerShell che il provider espone al runtime di Windows PowerShell durante l'elaborazione del comando.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-133">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="f5ea7-134">Per questo provider, non sono disponibili funzionalità specifiche di Windows PowerShell che vengono aggiunti.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-134">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="f5ea7-135">Definizione funzionalità di Base</span><span class="sxs-lookup"><span data-stu-id="f5ea7-135">Defining Base Functionality</span></span>

<span data-ttu-id="f5ea7-136">Come descritto in [Design Your PS Provider](./designing-your-windows-powershell-provider.md), il [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) classe base derivi da altre classi che ha fornito provider diverso funzionalità.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-136">As described in [Design Your PS Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="f5ea7-137">Un provider di navigazione di Windows PowerShell, pertanto, è necessario definire tutte le funzionalità fornite da tali classi.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-137">A Windows PowerShell navigation provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="f5ea7-138">Per implementare la funzionalità per l'aggiunta di informazioni di inizializzazione specifiche della sessione e per il rilascio delle risorse usate dal provider, vedere [creazione di un Provider di PS base](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-138">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic PS Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="f5ea7-139">Tuttavia, la maggior parte dei fornitori (tra cui il provider descritto di seguito) è possono usare l'implementazione predefinita di questa funzionalità fornita da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-139">However, most providers (including the provider described here) can use the default implementation of this functionality provided by Windows PowerShell.</span></span>

<span data-ttu-id="f5ea7-140">Per ottenere l'accesso all'archivio dati tramite un'unità di Windows PowerShell, è necessario implementare i metodi del [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe di base.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-140">To get access to the data store through a Windows PowerShell drive, you must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="f5ea7-141">Per altre informazioni sull'implementazione di questi metodi, vedere [creazione di un Provider di unità di Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-141">For more information about implementing these methods, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="f5ea7-142">Per modificare gli elementi di un archivio dati, ad esempio il recupero, impostazione e cancellare elementi, il provider deve implementare i metodi forniti dal [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) classe di base.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-142">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="f5ea7-143">Per altre informazioni sull'implementazione di questi metodi, vedere [creazione di un Provider di Windows PowerShell elemento](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-143">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

<span data-ttu-id="f5ea7-144">Per ottenere gli elementi figlio o i nomi, dell'archivio dati, nonché i metodi che creano, copiano, rinominano e rimuovere elementi, è necessario implementare i metodi forniti dal [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)classe di base.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-144">To get to the child items, or their names, of the data store, as well as methods that create, copy, rename, and remove items, you must implement the methods provided by the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="f5ea7-145">Per altre informazioni sull'implementazione di questi metodi, vedere [creazione di un Provider di contenitore di Windows PowerShell](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-145">For more information about implementing these methods, see [Creating a Windows PowerShell Container Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="creating-a-windows-powershell-path"></a><span data-ttu-id="f5ea7-146">Creazione di un percorso di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-146">Creating a Windows PowerShell Path</span></span>

<span data-ttu-id="f5ea7-147">Provider di navigazione di Windows PowerShell utilizzare un percorso di Windows PowerShell interna al provider per passare gli elementi dell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-147">Windows PowerShell navigation provider use a provider-internal Windows PowerShell path to navigate the items of the data store.</span></span> <span data-ttu-id="f5ea7-148">Per creare un percorso interna al provider il provider deve implementare il [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) metodo supporta la chiama del cmdlet Combine-Path.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-148">To create a provider-internal path the provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method to supports calls from the Combine-Path cmdlet.</span></span> <span data-ttu-id="f5ea7-149">Questo metodo combina un percorso padre e figlio in un percorso di provider interno, usando un separatore di percorso specifico del provider tra i percorsi padre e figlio.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-149">This method combines a parent and child path into a provider-internal path, using a provider-specific path separator between the parent and child paths.</span></span>

<span data-ttu-id="f5ea7-150">L'implementazione predefinita accetta percorsi con "/" o "\\"come separatore di percorso, Normalizza il separatore di percorso"\\" combina le parti del percorso padre e figlio con il separatore tra di essi e quindi restituisce una stringa che contiene il percorsi combinati.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-150">The default implementation takes paths with "/" or "\\" as the path separator, normalizes the path separator to "\\", combines the parent and child path parts with the separator between them, and then returns a string that contains the combined paths.</span></span>

<span data-ttu-id="f5ea7-151">Questo provider di navigazione non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-151">This navigation provider does not implement this method.</span></span> <span data-ttu-id="f5ea7-152">Tuttavia, il codice seguente è l'implementazione predefinita del [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) (metodo).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-152">However, the following code is the default implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermakepath](Msh_samplestestcmdlets#testprovidermakepath)]  -->

#### <a name="things-to-remember-about-implementing-makepath"></a><span data-ttu-id="f5ea7-153">Aspetti da ricordare sull'implementazione MakePath</span><span class="sxs-lookup"><span data-stu-id="f5ea7-153">Things to Remember About Implementing MakePath</span></span>

<span data-ttu-id="f5ea7-154">Le condizioni seguenti possono si applicano all'implementazione di [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span><span class="sxs-lookup"><span data-stu-id="f5ea7-154">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span></span>

- <span data-ttu-id="f5ea7-155">L'implementazione del [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) metodo non deve convalidare il percorso come un percorso completo valido nello spazio dei nomi del provider.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-155">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method should not validate the path as a legal fully-qualified path in the provider namespace.</span></span> <span data-ttu-id="f5ea7-156">Tenere presente che ogni parametro può rappresentare solo una parte di un percorso e le parti combinate non potrebbero generare un percorso completo.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-156">Be aware that each parameter can only represent a part of a path, and the combined parts might not generate a fully-qualified path.</span></span> <span data-ttu-id="f5ea7-157">Ad esempio, il [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) metodo per il provider filesystem potrebbe ricevere "windows\system32" nel `parent` parametro e "abc. dll" nel `child` parametro.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-157">For example, the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method for the filesystem provider might receive "windows\system32" in the `parent` parameter and "abc.dll" in the `child` parameter.</span></span> <span data-ttu-id="f5ea7-158">Il metodo viene aggiunto a questi valori con la "\\" seguito dal separatore e restituisce "windows\system32\abc.dll", che non è un percorso completo.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-158">The method joins these values with the "\\" separator and returns "windows\system32\abc.dll", which is not a fully-qualified file system path.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="f5ea7-159">Le parti del percorso fornite nella chiamata a [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) potrebbe contenere caratteri non consentiti nello spazio dei nomi del provider.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-159">The path parts provided in the call to [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) might contain characters not allowed in the provider namespace.</span></span> <span data-ttu-id="f5ea7-160">Questi caratteri vengono probabilmente utilizzati per l'espansione di caratteri jolly e l'implementazione di questo metodo non necessario rimuoverli.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-160">These characters are most likely used for wildcard expansion and the implementation of this method should not remove them.</span></span>

## <a name="retrieving-the-parent-path"></a><span data-ttu-id="f5ea7-161">Recupero del percorso dell'elemento padre</span><span class="sxs-lookup"><span data-stu-id="f5ea7-161">Retrieving the Parent Path</span></span>

<span data-ttu-id="f5ea7-162">Provider di navigazione di Windows PowerShell implementa il [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) recuperare la parte padre del functoid con registrazione completa o parziale (metodo) percorso specifico del provider.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-162">Windows PowerShell navigation providers implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method to retrieve the parent part of the indicated full or partial provider-specific path.</span></span> <span data-ttu-id="f5ea7-163">Il metodo rimuove la parte figlio del percorso e restituisce l'elemento padre come parte di percorso.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-163">The method removes the child part of the path and returns the parent path part.</span></span> <span data-ttu-id="f5ea7-164">Il `root` parametro specifica il percorso completo della radice di un'unità.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-164">The `root` parameter specifies the fully-qualified path to the root of a drive.</span></span> <span data-ttu-id="f5ea7-165">Questo parametro può essere null o vuoto se un'unità montata non è in uso per l'operazione di recupero.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-165">This parameter can be null or empty if a mounted drive is not in use for the retrieval operation.</span></span> <span data-ttu-id="f5ea7-166">Se si specifica una radice, il metodo deve restituire un percorso a un contenitore nello stesso albero come radice.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-166">If a root is specified, the method must return a path to a container in the same tree as the root.</span></span>

<span data-ttu-id="f5ea7-167">Il provider di navigazione di esempio non esegue l'override di questo metodo, ma utilizza l'implementazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-167">The sample navigation provider does not override this method, but uses the default implementation.</span></span> <span data-ttu-id="f5ea7-168">Accetta percorsi che usano entrambi "/" e "\\" come separatore di percorso.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-168">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="f5ea7-169">Innanzitutto Normalizza il percorso è disponibile solo "\\" separatori, quindi divide il percorso padre all'ultimo "\\" e restituisce il percorso padre.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-169">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the parent path.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetparentpath](Msh_samplestestcmdlets#testprovidergetparentpath)]  -->

#### <a name="to-remember-about-implementing-getparentpath"></a><span data-ttu-id="f5ea7-170">Tenere presente sull'implementazione GetParentPath</span><span class="sxs-lookup"><span data-stu-id="f5ea7-170">To Remember About Implementing GetParentPath</span></span>

<span data-ttu-id="f5ea7-171">L'implementazione del [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) metodo deve dividere il tracciato lessicalmente su separatore di percorso per lo spazio dei nomi del provider.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-171">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method should split the path lexically on the path separator for the provider namespace.</span></span> <span data-ttu-id="f5ea7-172">Ad esempio, il provider filesystem utilizza questo metodo per cercare l'ultima "\\" e restituisce tutti gli elementi a sinistra del separatore.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-172">For example, the filesystem provider uses this method to look for the last "\\" and returns everything to the left of the separator.</span></span>

## <a name="retrieve-the-child-path-name"></a><span data-ttu-id="f5ea7-173">Recuperare il nome del percorso figlio</span><span class="sxs-lookup"><span data-stu-id="f5ea7-173">Retrieve the Child Path Name</span></span>

<span data-ttu-id="f5ea7-174">Implementa il provider navigazione il [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) metodo per recuperare il nome (elemento foglia) dell'elemento figlio dell'elemento che si trova in alla versione completa indicata o percorso parziale specifico del provider.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-174">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method to retrieve the name (leaf element) of the child of the item located at the indicated full or partial provider-specific path.</span></span>

<span data-ttu-id="f5ea7-175">Il provider di navigazione di esempio non esegue l'override di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-175">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="f5ea7-176">Di seguito è riportata l'implementazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-176">The default implementation is shown below.</span></span> <span data-ttu-id="f5ea7-177">Accetta percorsi che usano entrambi "/" e "\\" come separatore di percorso.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-177">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="f5ea7-178">Innanzitutto Normalizza il percorso è disponibile solo "\\" separatori, quindi divide il percorso padre all'ultimo "\\" e restituisce il nome dell'elemento figlio come parte di percorso.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-178">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the name of the child path part.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildname](Msh_samplestestcmdlets#testprovidergetchildname)]  -->

#### <a name="things-to-remember-about-implementing-getchildname"></a><span data-ttu-id="f5ea7-179">Aspetti da ricordare sull'implementazione GetChildName</span><span class="sxs-lookup"><span data-stu-id="f5ea7-179">Things to Remember About Implementing GetChildName</span></span>

<span data-ttu-id="f5ea7-180">L'implementazione del [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) metodo deve dividere il tracciato lessicalmente su separatore di percorso.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-180">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method should split the path lexically on the path separator.</span></span> <span data-ttu-id="f5ea7-181">Se il percorso specificato non contiene separatori alcun percorso, il metodo deve restituire il percorso senza modificato.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-181">If the supplied path contains no path separators, the method should return the path unmodified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f5ea7-182">Il percorso specificato nella chiamata a questo metodo potrebbe contenere caratteri che non sono validi nello spazio dei nomi del provider.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-182">The path provided in the call to this method might contain characters that are illegal in the provider namespace.</span></span> <span data-ttu-id="f5ea7-183">Questi caratteri sono probabilmente usato per la corrispondenza di espressione regolare o espansione di caratteri jolly e l'implementazione di questo metodo non necessario rimuoverli.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-183">These characters are most likely used for wildcard expansion or regular expression matching, and the implementation of this method should not remove them.</span></span>

## <a name="determining-if-an-item-is-a-container"></a><span data-ttu-id="f5ea7-184">Determinare se un elemento è un contenitore</span><span class="sxs-lookup"><span data-stu-id="f5ea7-184">Determining if an Item is a Container</span></span>

<span data-ttu-id="f5ea7-185">Il provider di navigazione può implementare il [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) metodo per determinare se il percorso specificato indica un contenitore.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-185">The navigation provider can implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) method to determine if the specified path indicates a container.</span></span> <span data-ttu-id="f5ea7-186">Restituisce true se il percorso rappresenta un contenitore e false in caso contrario.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-186">It returns true if the path represents a container, and false otherwise.</span></span> <span data-ttu-id="f5ea7-187">L'utente deve essere in grado di usare questo metodo il `Test-Path` cmdlet per il percorso fornito.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-187">The user needs this method to be able to use the `Test-Path` cmdlet for the supplied path.</span></span>

<span data-ttu-id="f5ea7-188">Il codice seguente illustra il [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementazione nel nostro provider di navigazione di esempio.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-188">The following code shows the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementation in our sample navigation provider.</span></span> <span data-ttu-id="f5ea7-189">Il metodo verifica che il percorso specificato sia corretto e se la tabella esiste e restituisce true se il percorso indica un contenitore.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-189">The method verifies that  the specified path is correct and if the table exists, and returns true if the path indicates a container.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L847-L872 "AccessDBProviderSample05.cs")]

#### <a name="things-to-remember-about-implementing-isitemcontainer"></a><span data-ttu-id="f5ea7-190">Aspetti da ricordare sull'implementazione IsItemContainer</span><span class="sxs-lookup"><span data-stu-id="f5ea7-190">Things to Remember About Implementing IsItemContainer</span></span>

<span data-ttu-id="f5ea7-191">Il provider di navigazione classe .NET può dichiarare funzionalità del provider di ExpandWildcards, filtro, inclusione o esclusione, dal [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-191">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f5ea7-192">In questo caso, l'implementazione di [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) deve garantire che il percorso passato soddisfi i requisiti.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-192">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) needs to ensure that the path passed meets requirements.</span></span> <span data-ttu-id="f5ea7-193">A tale scopo, il metodo deve accedere alla proprietà appropriata, ad esempio, il [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) proprietà.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-193">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) property.</span></span>

## <a name="moving-an-item"></a><span data-ttu-id="f5ea7-194">Spostamento di un elemento</span><span class="sxs-lookup"><span data-stu-id="f5ea7-194">Moving an Item</span></span>

<span data-ttu-id="f5ea7-195">Supportare le `Move-Item` implementa il provider di navigazione di cmdlet, il [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) (metodo).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-195">In support of the `Move-Item` cmdlet, your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="f5ea7-196">Questo metodo consente di spostare l'elemento specificato tramite il `path` del contenitore nel percorso specificato nel parametro il `destination` parametro.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-196">This method moves the item specified by the `path` parameter to the container at the path supplied in the `destination` parameter.</span></span>

<span data-ttu-id="f5ea7-197">Il provider di navigazione di esempio non esegue l'override di [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) (metodo).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-197">The sample navigation provider does not override the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="f5ea7-198">Di seguito è l'implementazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-198">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitem](Msh_samplestestcmdlets#testprovidermoveitem)]  -->

#### <a name="things-to-remember-about-implementing-moveitem"></a><span data-ttu-id="f5ea7-199">Aspetti da ricordare sull'implementazione MoveItem</span><span class="sxs-lookup"><span data-stu-id="f5ea7-199">Things to Remember About Implementing MoveItem</span></span>

<span data-ttu-id="f5ea7-200">Il provider di navigazione classe .NET può dichiarare funzionalità del provider di ExpandWildcards, filtro, inclusione o esclusione, dal [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-200">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f5ea7-201">In questo caso, l'implementazione di [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) necessario assicurarsi che il percorso passato soddisfi i requisiti.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-201">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) must ensure that the path passed meets requirements.</span></span> <span data-ttu-id="f5ea7-202">A tale scopo, il metodo deve accedere alla proprietà appropriata, ad esempio, il **CmdletProvider.Exclude** proprietà.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-202">To do this, the method should access the appropriate property, for example, the **CmdletProvider.Exclude** property.</span></span>

<span data-ttu-id="f5ea7-203">Per impostazione predefinita, gli override di questo metodo devono non spostare gli oggetti tramite gli oggetti esistenti, a meno che il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) è impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-203">By default, overrides of this method should not move objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="f5ea7-204">Ad esempio, il provider filesystem non copierà c:\temp\abc.txt tramite un file esistente c:\bar.txt a meno che non la [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) è impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-204">For example, the filesystem provider will not copy c:\temp\abc.txt over an existing c:\bar.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="f5ea7-205">Se il percorso specificato nella `destination` parametro esista e sia un contenitore, il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) proprietà non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-205">If the path specified in the `destination` parameter exists and is a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="f5ea7-206">In questo caso, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) consigliabile spostare l'elemento indicato dal `path` parametro per il contenitore indicato dal `destination` parametro come elemento figlio.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-206">In this case, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) should move the item indicated by the `path` parameter to the container indicated by the `destination` parameter as a child.</span></span>

<span data-ttu-id="f5ea7-207">L'implementazione del [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) metodo deve chiamare [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e controllare il valore restituito corrispondente prima di apportare modifiche all'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-207">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="f5ea7-208">Questo metodo viene utilizzato per confermare l'esecuzione di un'operazione quando viene apportata una modifica lo stato del sistema, ad esempio, l'eliminazione di file.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-208">This method is used to confirm execution of an operation when a change is made to system state, for example, deleting files.</span></span> <span data-ttu-id="f5ea7-209">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) invia il nome della risorsa da modificare per l'utente, con il runtime di Windows PowerShell prendendo in considerazione eventuali impostazioni riga di comando o variabili di preferenza in determinare ciò che deve essere visualizzato all'utente.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-209">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed to the user.</span></span>

<span data-ttu-id="f5ea7-210">Dopo la chiamata a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) restituisce `true`, il [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) metodo deve chiamare il [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) (metodo).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-210">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="f5ea7-211">Questo metodo invia un messaggio all'utente per consentire il feedback a dire se l'operazione deve proseguire.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-211">This method sends a message to the user to allow feedback to say if the operation should be continued.</span></span> <span data-ttu-id="f5ea7-212">Il provider deve chiamare [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) come verifica aggiuntiva per le modifiche del sistema potenzialmente pericolose.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-212">Your provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-move-item-cmdlet"></a><span data-ttu-id="f5ea7-213">Associare i parametri dinamici per il Cmdlet Move-Item</span><span class="sxs-lookup"><span data-stu-id="f5ea7-213">Attaching Dynamic Parameters to the Move-Item Cmdlet</span></span>

<span data-ttu-id="f5ea7-214">In alcuni casi il `Move-Item` cmdlet richiede parametri aggiuntivi che vengono forniti in modo dinamico in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-214">Sometimes the `Move-Item` cmdlet requires additional parameters that are provided dynamically at runtime.</span></span> <span data-ttu-id="f5ea7-215">Per fornire i parametri dinamici, il provider di navigazione deve implementare il [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) metodo per ottenere i valori dei parametri obbligatori dall'elemento in corrispondenza il percorso indicato e restituire un oggetto che dispone di proprietà e campi con l'analisi degli attributi simili a una classe cmdlet o una [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) oggetto.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-215">To provide these dynamic parameters, the navigation provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) method to get the required parameter values from the item at the indicated path, and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="f5ea7-216">Questo provider di navigazione non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-216">This navigation provider does not implement this method.</span></span> <span data-ttu-id="f5ea7-217">Tuttavia, il codice seguente è l'implementazione predefinita di [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-217">However, the following code is the default implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters](Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters)]  -->

## <a name="normalizing-a-relative-path"></a><span data-ttu-id="f5ea7-218">Normalizzazione di un percorso relativo</span><span class="sxs-lookup"><span data-stu-id="f5ea7-218">Normalizing a Relative Path</span></span>

<span data-ttu-id="f5ea7-219">Implementa il provider navigazione il [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) metodo normalizzare il percorso completo è indicato nel `path` parametro come in corso relativo al percorso specificato da di `basePath` parametro.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-219">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) method to normalize the fully-qualified path indicated in the `path` parameter as being relative to the path specified by the `basePath` parameter.</span></span> <span data-ttu-id="f5ea7-220">Il metodo restituisce una rappresentazione di stringa del percorso normalizzato.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-220">The method returns a string representation of the normalized path.</span></span> <span data-ttu-id="f5ea7-221">Scrive un errore se il `path` parametro specifica un percorso inesistente.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-221">It writes an error if the `path` parameter specifies a nonexistent path.</span></span>

<span data-ttu-id="f5ea7-222">Il provider di navigazione di esempio non esegue l'override di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-222">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="f5ea7-223">Di seguito è l'implementazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-223">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernormalizepath](Msh_samplestestcmdlets#testprovidernormalizepath)]  -->

#### <a name="things-to-remember-about-implementing-normalizerelativepath"></a><span data-ttu-id="f5ea7-224">Aspetti da ricordare sull'implementazione NormalizeRelativePath</span><span class="sxs-lookup"><span data-stu-id="f5ea7-224">Things to Remember About Implementing NormalizeRelativePath</span></span>

<span data-ttu-id="f5ea7-225">L'implementazione di [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) devono analizzare il `path` parametro, ma non è necessario utilizzare l'analisi puramente sintattico.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-225">Your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) should parse the `path` parameter, but it does not have to use purely syntactical parsing.</span></span> <span data-ttu-id="f5ea7-226">Si sono invitati a progettazione questo metodo per utilizzare il percorso per cercare le informazioni sul percorso dell'archivio dati e creare un percorso che corrisponde alle maiuscole e minuscole e standardizzato sintassi del percorso.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-226">You are encouraged to design this method to use the path to look up the path information in the data store and create a path that matches the casing and standardized path syntax.</span></span>

## <a name="code-sample"></a><span data-ttu-id="f5ea7-227">Esempio di codice</span><span class="sxs-lookup"><span data-stu-id="f5ea7-227">Code Sample</span></span>

<span data-ttu-id="f5ea7-228">Per il codice di esempio completo, vedere [esempio di codice AccessDbProviderSample05](./accessdbprovidersample05-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-228">For complete sample code, see [AccessDbProviderSample05 Code Sample](./accessdbprovidersample05-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="f5ea7-229">Definizione di tipi di oggetto e formattazione</span><span class="sxs-lookup"><span data-stu-id="f5ea7-229">Defining Object Types and Formatting</span></span>

<span data-ttu-id="f5ea7-230">È possibile che un provider aggiungere i membri per gli oggetti esistenti o definire nuovi oggetti.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-230">It is possible for a provider to add members to existing objects or define new objects.</span></span> <span data-ttu-id="f5ea7-231">Per altre informazioni, vedere[estendendo i tipi di oggetto e formattazione](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-231">For more information, see[Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="f5ea7-232">Creazione del provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-232">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="f5ea7-233">Per altre informazioni, vedere [come registrare i cmdlet, provider e applicazioni Host](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="f5ea7-233">For more information, see [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="f5ea7-234">Test di un provider Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-234">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="f5ea7-235">Quando il provider di Windows PowerShell è stato registrato con Windows PowerShell, è possibile eseguirne il test eseguendo il cmdlet supportati nella riga di comando, inclusi i cmdlet resi disponibili dalla derivazione.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-235">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line, including cmdlets made available by derivation.</span></span> <span data-ttu-id="f5ea7-236">In questo esempio verrà testati i provider di navigazione di esempio.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-236">This example will test the sample navigation provider.</span></span>

1. <span data-ttu-id="f5ea7-237">Eseguire la nuova shell e usare il `Set-Location` cmdlet per impostare il percorso per indicare il database di Access.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-237">Run your new shell and use the `Set-Location` cmdlet to set the path to indicate the Access database.</span></span>

   ```powershell
   Set-Location mydb:
   ```

2. <span data-ttu-id="f5ea7-238">Eseguire ora il `Get-Childitem` cmdlet per recuperare un elenco degli elementi del database, quali sono le tabelle di database disponibili.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-238">Now run the `Get-Childitem` cmdlet to retrieve a list of the database items, which are the available database tables.</span></span> <span data-ttu-id="f5ea7-239">Per ogni tabella, questo cmdlet recupera anche il numero di righe della tabella.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-239">For each table, this cmdlet also retrieves the number of table rows.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rowcount,name -AutoSize
   ```

   ```output
   RowCount   Name
   --------   ----
        180   MSysAccessObjects
          0   MSysACEs
          1   MSysCmdbars
          0   MSysIMEXColumns
          0   MSysIMEXSpecs
          0   MSysObjects
          0   MSysQueries
          7   MSysRelationships
          8   Categories
         91   Customers
          9   Employees
       2155   Order Details
        830   Orders
         77   Products
          3   Shippers
         29   Suppliers
   ```

3. <span data-ttu-id="f5ea7-240">Usare il `Set-Location` cmdlet per impostare il percorso della tabella di dati dipendenti.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-240">Use the `Set-Location` cmdlet again to set the location of the Employees data table.</span></span>

   ```powershell
   Set-Location Employees
   ```

4. <span data-ttu-id="f5ea7-241">Si usi ora il `Get-Location` cmdlet per recuperare il percorso per la tabella Employees.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-241">Let's now use the `Get-Location` cmdlet to retrieve the path to the Employees table.</span></span>

   ```powershell
   Get-Location
   ```

   ```output
   Path
   ----
   mydb:\Employees
   ```

5. <span data-ttu-id="f5ea7-242">A questo punto usare il `Get-Childitem` cmdlet inviato tramite pipe al `Format-Table` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-242">Now use the `Get-Childitem` cmdlet piped to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="f5ea7-243">Questo set di cmdlet recupera gli elementi per la tabella di dati dipendenti, quali sono le righe della tabella.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-243">This set of cmdlets retrieves the items for the Employees data table, which are the table rows.</span></span> <span data-ttu-id="f5ea7-244">Sono formattati come specificato da di `Format-Table` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-244">They are formatted as specified by the `Format-Table` cmdlet.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rownumber,psiscontainer,data -AutoSize
   ```

   ```output
   RowNumber   PSIsContainer   Data
   ---------   --------------   ----
   0           False            System.Data.DataRow
   1           False            System.Data.DataRow
   2           False            System.Data.DataRow
   3           False            System.Data.DataRow
   4           False            System.Data.DataRow
   5           False            System.Data.DataRow
   6           False            System.Data.DataRow
   7           False            System.Data.DataRow
   8           False            System.Data.DataRow
   ```

6. <span data-ttu-id="f5ea7-245">È ora possibile eseguire il `Get-Item` cmdlet per recuperare gli elementi per riga 0 della tabella di dati dipendenti.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-245">You can now run the `Get-Item` cmdlet to retrieve the items for row 0 of the Employees data table.</span></span>

   ```powershell
   Get-Item 0
   ```

   ```output
   PSPath        : AccessDB::C:\PS\Northwind.mdb\Employees\0
   PSParentPath  : AccessDB::C:\PS\Northwind.mdb\Employees
   PSChildName   : 0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data           : System.Data.DataRow
   RowNumber      : 0
   ```

7. <span data-ttu-id="f5ea7-246">Usare il `Get-Item` cmdlet per recuperare i dati dei dipendenti per gli elementi nella riga 0.</span><span class="sxs-lookup"><span data-stu-id="f5ea7-246">Use the `Get-Item` cmdlet again to retrieve the employee data for the items in row 0.</span></span>

   ```powershell
   (Get-Item 0).data
   ```

   ```output
   EmployeeID      : 1
   LastName        : Davis
   FirstName       : Sara
   Title           : Sales Representative
   TitleOfCourtesy : Ms.
   BirthDate       : 12/8/1968 12:00:00 AM
   HireDate        : 5/1/1992 12:00:00 AM
   Address         : 4567 Main Street
                     Apt. 2A
   City            : Buffalo
   Region          : NY
   PostalCode      : 98052
   Country         : USA
   HomePhone       : (206) 555-9857
   Extension       : 5467
   Photo           : EmpID1.bmp
   Notes           : Education includes a BA in psychology from
                     Colorado State University. She also completed "The
                     Art of the Cold Call."  Nancy is a member of
                     Toastmasters International.
   ReportsTo       : 2
   ```

## <a name="see-also"></a><span data-ttu-id="f5ea7-247">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="f5ea7-247">See Also</span></span>

[<span data-ttu-id="f5ea7-248">Creazione di provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-248">Creating Windows PowerShell providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="f5ea7-249">Provider di progettazione di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-249">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="f5ea7-250">Estensione di tipi di oggetto e la formattazione</span><span class="sxs-lookup"><span data-stu-id="f5ea7-250">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="f5ea7-251">Implementare un provider di contenitori Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-251">Implement a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="f5ea7-252">Come registrare i cmdlet, provider e applicazioni Host</span><span class="sxs-lookup"><span data-stu-id="f5ea7-252">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="f5ea7-253">Guida per programmatori di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f5ea7-253">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="f5ea7-254">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="f5ea7-254">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)