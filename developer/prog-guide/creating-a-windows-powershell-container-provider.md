---
title: Creazione di un Provider di contenitore di Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: 33effed9a96cf1b9ee5f1a50b60a1937526db9d1
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/16/2019
ms.locfileid: "58055020"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="54d3f-102">Creazione di un provider di contenitori di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="54d3f-103">In questo argomento viene descritto come creare un provider di Windows PowerShell che possa usare gli archivi dati a più livelli.</span><span class="sxs-lookup"><span data-stu-id="54d3f-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="54d3f-104">Per questo tipo di archivio dati, il livello principale dell'archivio contiene gli elementi radice e ogni livello successivo viene considerato come un nodo di elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="54d3f-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="54d3f-105">Tramite l'archivio dati, consentendo all'utente di lavorare su questi nodi figlio, un utente può interagire in modo gerarchico.</span><span class="sxs-lookup"><span data-stu-id="54d3f-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="54d3f-106">I provider compatibile con gli archivi dati a più livelli sono dette provider di contenitore di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="54d3f-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="54d3f-107">Tuttavia, tenere presente che è possibile utilizzare un provider di contenitore di Windows PowerShell solo quando è presente un contenitore (non i contenitori nidificati) con gli elementi in esso.</span><span class="sxs-lookup"><span data-stu-id="54d3f-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="54d3f-108">Se sono presenti contenitori annidati, è necessario implementare un provider di navigazione di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="54d3f-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="54d3f-109">Per altre informazioni sull'implementazione del provider di navigazione di Windows PowerShell, vedere [creazione di un Provider di navigazione di Windows PowerShell](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="54d3f-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="54d3f-110">È possibile scaricare il C# file di origine (AccessDBSampleProvider04.cs) per questo provider tramite il Microsoft Windows Software Development Kit per Windows Vista e i componenti di Runtime di .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="54d3f-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="54d3f-111">Per istruzioni sul download, vedere [come installare Windows PowerShell e il Download di Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="54d3f-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="54d3f-112">Sono disponibili in file di origine scaricato il  **\<esempi di PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="54d3f-112">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="54d3f-113">Per altre informazioni sulle altre implementazioni del provider di Windows PowerShell, vedere [la progettazione del Provider di Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="54d3f-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="54d3f-114">Il provider di contenitore di Windows PowerShell descritto di seguito definisce il database come relativo contenitore singolo, con le tabelle e le righe del database definiti come elementi del contenitore.</span><span class="sxs-lookup"><span data-stu-id="54d3f-114">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="54d3f-115">Tenere presente che questa progettazione si presuppone che un database con un campo con l'ID del nome e che il tipo del campo è LongInteger.</span><span class="sxs-lookup"><span data-stu-id="54d3f-115">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="54d3f-116">Ecco un elenco delle sezioni in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="54d3f-116">Here is a list of the sections in this topic.</span></span> <span data-ttu-id="54d3f-117">Se non si ha familiarità con la scrittura di un provider di contenitore di Windows PowerShell, leggere queste informazioni nell'ordine in cui viene visualizzato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-117">If you are unfamiliar with writing a Windows PowerShell container provider, please read this information in the order that it appears.</span></span> <span data-ttu-id="54d3f-118">Tuttavia, se si ha familiarità con la scrittura di un provider di contenitore di Windows PowerShell, passare direttamente alle informazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="54d3f-118">However, if you are familiar with writing a Windows PowerShell container provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="54d3f-119">Definizione di una classe di Provider contenitore di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-119">Defining a Windows PowerShell Container Provider Class</span></span>](#Defining-a-Windows-PowerShell-Container-Provider-Class)

- [<span data-ttu-id="54d3f-120">Definizione funzionalità di Base</span><span class="sxs-lookup"><span data-stu-id="54d3f-120">Defining Base Functionality</span></span>](#defining-base-functionality)

- [<span data-ttu-id="54d3f-121">Recupero degli elementi figlio</span><span class="sxs-lookup"><span data-stu-id="54d3f-121">Retrieving Child Items</span></span>](#Retrieving-Child-Items)

- [<span data-ttu-id="54d3f-122">Associare i parametri dinamici al `Get-ChildItem` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="54d3f-122">Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet)

- [<span data-ttu-id="54d3f-123">Il recupero dei nomi di elementi figlio</span><span class="sxs-lookup"><span data-stu-id="54d3f-123">Retrieving Child Item Names</span></span>](#Retrieving-Child-Item-Names)

- <span data-ttu-id="54d3f-124">[Associare i parametri dinamici al `Get-ChildItem` Cmdlet (nome)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span><span class="sxs-lookup"><span data-stu-id="54d3f-124">[Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet (Name)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span></span>

- [<span data-ttu-id="54d3f-125">Ridenominazione di elementi</span><span class="sxs-lookup"><span data-stu-id="54d3f-125">Renaming Items</span></span>](#Renaming-Items)

- [<span data-ttu-id="54d3f-126">Associare i parametri dinamici al `Rename-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="54d3f-126">Attaching Dynamic Parameters to the  `Rename-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Rename-Item-Cmdlet)

- [<span data-ttu-id="54d3f-127">Creazione di nuovi elementi</span><span class="sxs-lookup"><span data-stu-id="54d3f-127">Creating New Items</span></span>](#Creating-New-Items)

- [<span data-ttu-id="54d3f-128">Associare i parametri dinamici al `New-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="54d3f-128">Attaching Dynamic Parameters to the `New-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-New-Item-Cmdlet)

- [<span data-ttu-id="54d3f-129">Rimozione di elementi di un</span><span class="sxs-lookup"><span data-stu-id="54d3f-129">Removing a Items</span></span>](#Removing-Items)

- [<span data-ttu-id="54d3f-130">Associare i parametri dinamici al `Remove-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="54d3f-130">Attaching Dynamic Parameters to the `Remove-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Remove-Item-Cmdlet)

- [<span data-ttu-id="54d3f-131">L'esecuzione di query per gli elementi figlio</span><span class="sxs-lookup"><span data-stu-id="54d3f-131">Querying for Child Items</span></span>](#Querying-for-Child-Items)

- [<span data-ttu-id="54d3f-132">Copia gli elementi</span><span class="sxs-lookup"><span data-stu-id="54d3f-132">Coping Items</span></span>](#Copying-Items)

- [<span data-ttu-id="54d3f-133">Associare i parametri dinamici al `Copy-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="54d3f-133">Attaching Dynamic Parameters to the  `Copy-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Copy-Item-Cmdlet)

- [<span data-ttu-id="54d3f-134">Esempio di codice</span><span class="sxs-lookup"><span data-stu-id="54d3f-134">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="54d3f-135">Creazione del Provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-135">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-Provider)

- [<span data-ttu-id="54d3f-136">Test di un Provider Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-136">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-Provider)

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="54d3f-137">Definizione di una classe di Provider contenitore di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-137">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="54d3f-138">Un provider di contenitore di Windows PowerShell è necessario definire una classe .NET che deriva dal [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) classe di base.</span><span class="sxs-lookup"><span data-stu-id="54d3f-138">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="54d3f-139">Ecco la definizione di classe per il provider di contenitore di Windows PowerShell descritti in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-139">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="54d3f-140">Si noti che in questa definizione di classe il [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attributo include due parametri.</span><span class="sxs-lookup"><span data-stu-id="54d3f-140">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="54d3f-141">Il primo parametro specifica un nome descrittivo per il provider usato da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="54d3f-141">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="54d3f-142">Il secondo parametro specifica le funzionalità specifiche di Windows PowerShell che il provider espone al runtime di Windows PowerShell durante l'elaborazione del comando.</span><span class="sxs-lookup"><span data-stu-id="54d3f-142">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="54d3f-143">Per questo provider, non sono disponibili funzionalità specifiche di Windows PowerShell che vengono aggiunti.</span><span class="sxs-lookup"><span data-stu-id="54d3f-143">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="54d3f-144">Definizione funzionalità di Base</span><span class="sxs-lookup"><span data-stu-id="54d3f-144">Defining Base Functionality</span></span>

<span data-ttu-id="54d3f-145">Come descritto in [la progettazione del Provider di Windows PowerShell](./designing-your-windows-powershell-provider.md), il [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) classe deriva da molte altre classi fornite funzionalità del provider diversa.</span><span class="sxs-lookup"><span data-stu-id="54d3f-145">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="54d3f-146">Un provider di contenitore di Windows PowerShell, pertanto, deve definire tutte le funzionalità fornite da tali classi.</span><span class="sxs-lookup"><span data-stu-id="54d3f-146">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="54d3f-147">Per implementare la funzionalità per l'aggiunta di informazioni di inizializzazione specifiche della sessione e per il rilascio delle risorse usate dal provider, vedere [creazione di un PowerShell Provider di Windows base](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="54d3f-147">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="54d3f-148">Tuttavia, la maggior parte dei fornitori (tra cui il provider descritto di seguito) è possono usare l'implementazione predefinita di questa funzionalità fornita da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="54d3f-148">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="54d3f-149">Per ottenere l'accesso all'archivio dati, il provider deve implementare i metodi del [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe di base.</span><span class="sxs-lookup"><span data-stu-id="54d3f-149">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="54d3f-150">Per altre informazioni sull'implementazione di questi metodi, vedere [creazione di un Provider di unità di Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="54d3f-150">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="54d3f-151">Per modificare gli elementi di un archivio dati, ad esempio il recupero, impostazione e cancellare elementi, il provider deve implementare i metodi forniti dal [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) classe di base.</span><span class="sxs-lookup"><span data-stu-id="54d3f-151">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="54d3f-152">Per altre informazioni sull'implementazione di questi metodi, vedere [creazione di un Provider di Windows PowerShell elemento](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="54d3f-152">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="54d3f-153">Recupero degli elementi figlio</span><span class="sxs-lookup"><span data-stu-id="54d3f-153">Retrieving Child Items</span></span>

<span data-ttu-id="54d3f-154">Per recuperare un elemento figlio, il provider di contenitore di Windows PowerShell è necessario eseguire l'override di [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metodo per supportare le chiamate dal `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-154">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="54d3f-155">Questo metodo recupera gli elementi figlio dall'archivio dati e li scrive alla pipeline come oggetti.</span><span class="sxs-lookup"><span data-stu-id="54d3f-155">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="54d3f-156">Se il `recurse` parametro del cmdlet è specificato, il metodo recupera tutti gli elementi figlio indipendentemente dal livello sono a.</span><span class="sxs-lookup"><span data-stu-id="54d3f-156">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="54d3f-157">Se il `recurse` parametro viene omesso, il metodo recupera un solo livello degli elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="54d3f-157">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="54d3f-158">Ecco l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metodo per questo provider.</span><span class="sxs-lookup"><span data-stu-id="54d3f-158">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="54d3f-159">Si noti che questo metodo recupera gli elementi figlio in tutte le tabelle di database quando il percorso indica il database di Access e recupera gli elementi figlio dalle righe della tabella se il percorso indica una tabella di dati.</span><span class="sxs-lookup"><span data-stu-id="54d3f-159">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="54d3f-160">Aspetti da ricordare sull'implementazione GetChildItems</span><span class="sxs-lookup"><span data-stu-id="54d3f-160">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="54d3f-161">Le condizioni seguenti possono si applicano all'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="54d3f-161">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="54d3f-162">Quando si definisce la classe del provider, un provider di contenitore di Windows PowerShell potrebbe dichiarare funzionalità del provider di ExpandWildcards, filtro, inclusione o esclusione, dal [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-162">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="54d3f-163">In questi casi, l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) deve garantire che il percorso passato al metodo soddisfi i requisiti della classe specificata (metodo) funzionalità.</span><span class="sxs-lookup"><span data-stu-id="54d3f-163">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="54d3f-164">A tale scopo, il metodo deve accedere alla proprietà appropriata, ad esempio, il [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) proprietà.</span><span class="sxs-lookup"><span data-stu-id="54d3f-164">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="54d3f-165">L'implementazione di questo metodo deve tenere conto alcuna forma di accesso per l'elemento che potrebbe rendere visibili all'utente l'elemento.</span><span class="sxs-lookup"><span data-stu-id="54d3f-165">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="54d3f-166">Ad esempio, se un utente ha accesso in scrittura a un file tramite il provider FileSystem (fornito da Windows PowerShell), ma non l'accesso in lettura, il file esista ancora e [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) restituisce `true`.</span><span class="sxs-lookup"><span data-stu-id="54d3f-166">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="54d3f-167">L'implementazione potrebbe richiedere la verifica di un elemento padre per vedere se l'elemento figlio può essere enumerata.</span><span class="sxs-lookup"><span data-stu-id="54d3f-167">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="54d3f-168">Durante la scrittura di più elementi, il [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metodo può richiedere alcuni minuti.</span><span class="sxs-lookup"><span data-stu-id="54d3f-168">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="54d3f-169">È possibile progettare il provider per scrivere gli elementi usando il [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) metodo uno alla volta.</span><span class="sxs-lookup"><span data-stu-id="54d3f-169">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="54d3f-170">Utilizzando questa tecnica presenta gli elementi per l'utente in un flusso.</span><span class="sxs-lookup"><span data-stu-id="54d3f-170">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="54d3f-171">L'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) è responsabile del divieto una ricorsione infinita quando sono presenti collegamenti circolari e così via.</span><span class="sxs-lookup"><span data-stu-id="54d3f-171">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="54d3f-172">Un'eccezione di terminazione appropriata deve essere generata in modo da riflettere tale condizione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-172">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="54d3f-173">Associare i parametri dinamici per il Cmdlet Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="54d3f-173">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="54d3f-174">In alcuni casi il `Get-ChildItem` cmdlet che chiama [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) richiede parametri aggiuntivi che vengono specificati in modo dinamico in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-174">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="54d3f-175">Per fornire i parametri dinamici, il provider di contenitore di Windows PowerShell deve implementare il [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) (metodo).</span><span class="sxs-lookup"><span data-stu-id="54d3f-175">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="54d3f-176">Questo metodo recupera i parametri dinamici per l'elemento nel percorso indicato e restituisce un oggetto che dispone di proprietà e campi con analisi degli attributi simili a una classe cmdlet o una [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) oggetto.</span><span class="sxs-lookup"><span data-stu-id="54d3f-176">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="54d3f-177">Il runtime di Windows PowerShell Usa l'oggetto restituito per aggiungere i parametri di `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-177">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="54d3f-178">Questo provider di contenitore di Windows PowerShell non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-178">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="54d3f-179">Tuttavia, il codice seguente è l'implementazione predefinita di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-179">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="54d3f-180">Il recupero dei nomi di elementi figlio</span><span class="sxs-lookup"><span data-stu-id="54d3f-180">Retrieving Child Item Names</span></span>

<span data-ttu-id="54d3f-181">Per recuperare i nomi degli elementi figlio, il provider di contenitore di Windows PowerShell è necessario eseguire l'override di [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) metodo per supportare le chiamate dalle `Get-ChildItem`cmdlet quando relativo `Name` parametro è specificato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-181">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="54d3f-182">Questo metodo recupera i nomi degli elementi figlio per i percorso o figlio elemento i nomi specificati per tutti i contenitori se il `returnAllContainers` parametro del cmdlet è specificato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-182">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="54d3f-183">La porzione di foglia di un percorso è un nome di figlio.</span><span class="sxs-lookup"><span data-stu-id="54d3f-183">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="54d3f-184">Ad esempio, il nome figlio c:\windows\system32\abc.dll il percorso è "abc. dll".</span><span class="sxs-lookup"><span data-stu-id="54d3f-184">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="54d3f-185">Il nome del figlio per la directory c:\windows\system32 è "system32".</span><span class="sxs-lookup"><span data-stu-id="54d3f-185">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="54d3f-186">Ecco l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) metodo per questo provider.</span><span class="sxs-lookup"><span data-stu-id="54d3f-186">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="54d3f-187">Si noti che il metodo recupera i nomi di tabella, se il percorso specificato indica i database di Access (unità) e i numeri di riga se il percorso indica una tabella.</span><span class="sxs-lookup"><span data-stu-id="54d3f-187">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="54d3f-188">Aspetti da ricordare sull'implementazione GetChildNames</span><span class="sxs-lookup"><span data-stu-id="54d3f-188">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="54d3f-189">Le condizioni seguenti possono si applicano all'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="54d3f-189">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="54d3f-190">Quando si definisce la classe del provider, un provider di contenitore di Windows PowerShell potrebbe dichiarare funzionalità del provider di ExpandWildcards, filtro, inclusione o esclusione, dal [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-190">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="54d3f-191">In questi casi, l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) deve garantire che il percorso passato al metodo soddisfi i requisiti della classe specificata (metodo) funzionalità.</span><span class="sxs-lookup"><span data-stu-id="54d3f-191">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="54d3f-192">A tale scopo, il metodo deve accedere alla proprietà appropriata, ad esempio, il [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) proprietà.</span><span class="sxs-lookup"><span data-stu-id="54d3f-192">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="54d3f-193">Si verifica un'eccezione a questa regola quando le `returnAllContainers` parametro del cmdlet è specificato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-193">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="54d3f-194">In questo caso, il metodo deve recuperare qualsiasi nome figlio per un contenitore, anche se non corrispondono ai valori di [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), oppure [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) proprietà.</span><span class="sxs-lookup"><span data-stu-id="54d3f-194">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="54d3f-195">Per impostazione predefinita, gli override di questo metodo non devono recuperare i nomi degli oggetti che sono in genere nascoste all'utente, a meno che il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) è specificata la proprietà.</span><span class="sxs-lookup"><span data-stu-id="54d3f-195">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="54d3f-196">Se il percorso specificato indica un contenitore, il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) proprietà non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="54d3f-196">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="54d3f-197">L'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) è responsabile del divieto una ricorsione infinita quando sono presenti collegamenti circolari e così via.</span><span class="sxs-lookup"><span data-stu-id="54d3f-197">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="54d3f-198">Un'eccezione di terminazione appropriata deve essere generata in modo da riflettere tale condizione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-198">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="54d3f-199">Associare i parametri dinamici per il Cmdlet Get-ChildItem (nome)</span><span class="sxs-lookup"><span data-stu-id="54d3f-199">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="54d3f-200">In alcuni casi il `Get-ChildItem` cmdlet (con il `Name` parametro) richiede parametri aggiuntivi che vengono specificati in modo dinamico in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-200">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="54d3f-201">Per fornire i parametri dinamici, il provider di contenitore di Windows PowerShell deve implementare il [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) (metodo).</span><span class="sxs-lookup"><span data-stu-id="54d3f-201">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="54d3f-202">Questo metodo recupera i parametri dinamici per l'elemento nel percorso indicato e restituisce un oggetto che dispone di proprietà e campi con analisi degli attributi simili a una classe cmdlet o una [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) oggetto.</span><span class="sxs-lookup"><span data-stu-id="54d3f-202">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="54d3f-203">Il runtime di Windows PowerShell Usa l'oggetto restituito per aggiungere i parametri di `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-203">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="54d3f-204">Questo provider non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-204">This provider does not implement this method.</span></span> <span data-ttu-id="54d3f-205">Tuttavia, il codice seguente è l'implementazione predefinita di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-205">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="54d3f-206">Ridenominazione di elementi</span><span class="sxs-lookup"><span data-stu-id="54d3f-206">Renaming Items</span></span>

<span data-ttu-id="54d3f-207">Per rinominare un elemento, è necessario eseguire l'override di un provider di contenitore di Windows PowerShell il [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metodo per supportare le chiamate dal `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-207">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="54d3f-208">Questo metodo modifica il nome dell'elemento nel percorso specificato per il nuovo nome fornito.</span><span class="sxs-lookup"><span data-stu-id="54d3f-208">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="54d3f-209">Il nuovo nome deve essere sempre rispetto all'elemento padre (contenitore).</span><span class="sxs-lookup"><span data-stu-id="54d3f-209">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="54d3f-210">Questo provider non esegue l'override di [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) (metodo).</span><span class="sxs-lookup"><span data-stu-id="54d3f-210">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="54d3f-211">Tuttavia, di seguito è l'implementazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="54d3f-211">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="54d3f-212">Aspetti da ricordare sull'implementazione RenameItem</span><span class="sxs-lookup"><span data-stu-id="54d3f-212">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="54d3f-213">Le condizioni seguenti possono si applicano all'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="54d3f-213">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="54d3f-214">Quando si definisce la classe del provider, un provider di contenitore di Windows PowerShell potrebbe dichiarare funzionalità del provider di ExpandWildcards, filtro, inclusione o esclusione, dal [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-214">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="54d3f-215">In questi casi, l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) deve garantire che il percorso passato al metodo soddisfi i requisiti della classe specificata (metodo) funzionalità.</span><span class="sxs-lookup"><span data-stu-id="54d3f-215">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="54d3f-216">A tale scopo, il metodo deve accedere alla proprietà appropriata, ad esempio, il [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) proprietà.</span><span class="sxs-lookup"><span data-stu-id="54d3f-216">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="54d3f-217">Il [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metodo è stato progettato per la modifica del nome di un solo elemento e non per le operazioni di spostamento.</span><span class="sxs-lookup"><span data-stu-id="54d3f-217">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="54d3f-218">L'implementazione del metodo deve scrivere un errore se il `newName` parametro contiene separatori del percorso o in caso contrario, potrebbe causare l'elemento per modificarne il percorso padre.</span><span class="sxs-lookup"><span data-stu-id="54d3f-218">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="54d3f-219">Per impostazione predefinita, gli override di questo metodo devono non rinominare oggetti, a meno che il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) è specificata la proprietà.</span><span class="sxs-lookup"><span data-stu-id="54d3f-219">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="54d3f-220">Se il percorso specificato indica un contenitore, il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) proprietà non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="54d3f-220">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="54d3f-221">L'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metodo deve chiamare [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e controllare il valore restituito corrispondente prima di apportare modifiche all'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="54d3f-221">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="54d3f-222">Questo metodo viene utilizzato per confermare l'esecuzione di un'operazione quando viene apportata una modifica lo stato del sistema, ad esempio, la ridenominazione dei file.</span><span class="sxs-lookup"><span data-stu-id="54d3f-222">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="54d3f-223">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) invia il nome della risorsa da modificare per l'utente, con il runtime di Windows PowerShell prendendo in considerazione eventuali impostazioni riga di comando o variabili di preferenza in determinare ciò che deve essere visualizzato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-223">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="54d3f-224">Dopo la chiamata a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) restituisce `true`, il [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metodo deve chiamare il [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) (metodo).</span><span class="sxs-lookup"><span data-stu-id="54d3f-224">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="54d3f-225">Questo metodo invia un messaggio di un messaggio di conferma all'utente per consentire ulteriori commenti e suggerimenti a dire se l'operazione deve proseguire.</span><span class="sxs-lookup"><span data-stu-id="54d3f-225">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="54d3f-226">Un provider deve chiamare [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) come verifica aggiuntiva per le modifiche del sistema potenzialmente pericolose.</span><span class="sxs-lookup"><span data-stu-id="54d3f-226">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="54d3f-227">Associare i parametri dinamici per il Cmdlet Rename-Item</span><span class="sxs-lookup"><span data-stu-id="54d3f-227">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="54d3f-228">In alcuni casi il `Rename-Item` cmdlet richiede parametri aggiuntivi che vengono specificati in modo dinamico in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-228">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="54d3f-229">Per fornire i parametri dinamici, provider di contenitore di Windows PowerShell deve implementare il [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) (metodo).</span><span class="sxs-lookup"><span data-stu-id="54d3f-229">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="54d3f-230">Questo metodo recupera i parametri per l'elemento nel percorso indicato e restituisce un oggetto che dispone di proprietà e campi con analisi degli attributi simili a una classe cmdlet o una [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) oggetto.</span><span class="sxs-lookup"><span data-stu-id="54d3f-230">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="54d3f-231">Il runtime di Windows PowerShell Usa l'oggetto restituito per aggiungere i parametri di `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-231">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="54d3f-232">Questo provider di contenitore non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-232">This container provider does not implement this method.</span></span> <span data-ttu-id="54d3f-233">Tuttavia, il codice seguente è l'implementazione predefinita di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-233">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="54d3f-234">Creazione di nuovi elementi</span><span class="sxs-lookup"><span data-stu-id="54d3f-234">Creating New Items</span></span>

<span data-ttu-id="54d3f-235">Per creare nuovi elementi, è necessario implementare un provider di contenitore di [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metodo per supportare le chiamate dal `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-235">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="54d3f-236">Questo metodo crea un elemento di dati che si trova nel percorso specificato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-236">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="54d3f-237">Il `type` parametro del cmdlet contiene il tipo definito dal provider per il nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="54d3f-237">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="54d3f-238">Ad esempio, il provider FileSystem utilizza un `type` parametro con il valore "file" o "directory".</span><span class="sxs-lookup"><span data-stu-id="54d3f-238">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="54d3f-239">Il `newItemValue` parametro del cmdlet consente di specificare un valore specifico del provider per il nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="54d3f-239">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="54d3f-240">Ecco l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metodo per questo provider.</span><span class="sxs-lookup"><span data-stu-id="54d3f-240">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="54d3f-241">Aspetti da ricordare sull'implementazione NewItem</span><span class="sxs-lookup"><span data-stu-id="54d3f-241">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="54d3f-242">Le condizioni seguenti possono si applicano all'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="54d3f-242">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="54d3f-243">Il [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metodo deve eseguire un confronto tra maiuscole e minuscole della stringa passata il `type` parametro.</span><span class="sxs-lookup"><span data-stu-id="54d3f-243">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="54d3f-244">Deve inoltre consentire corrispondenze meno ambigue.</span><span class="sxs-lookup"><span data-stu-id="54d3f-244">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="54d3f-245">Per i tipi "file" e "directory", ad esempio, solo la prima lettera è necessario per risolvere l'ambiguità.</span><span class="sxs-lookup"><span data-stu-id="54d3f-245">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="54d3f-246">Se il `type` parametro indica un tipo non è possibile creare il provider, il [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metodo deve scrivere un'eccezione ArgumentException con un messaggio il provider che indicano i tipi può creare.</span><span class="sxs-lookup"><span data-stu-id="54d3f-246">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="54d3f-247">Per il `newItemValue` parametro, l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metodo è consigliato per accettare stringhe come minimo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-247">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="54d3f-248">È anche necessario accettare il tipo di oggetto che viene recuperato dal [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) metodo per lo stesso percorso.</span><span class="sxs-lookup"><span data-stu-id="54d3f-248">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="54d3f-249">Il [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metodo può utilizzare il [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) metodo per convertire i tipi di tipo desiderato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-249">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="54d3f-250">L'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metodo deve chiamare [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e controllare il valore restituito corrispondente prima di apportare modifiche all'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="54d3f-250">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="54d3f-251">Dopo la chiamata a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) restituisce true, il [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) il metodo deve chiamare il [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metodo come un ulteriore controllo per le modifiche del sistema potenzialmente pericolose.</span><span class="sxs-lookup"><span data-stu-id="54d3f-251">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="54d3f-252">Associare i parametri dinamici per il Cmdlet New-Item</span><span class="sxs-lookup"><span data-stu-id="54d3f-252">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="54d3f-253">In alcuni casi il `New-Item` cmdlet richiede parametri aggiuntivi che vengono specificati in modo dinamico in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-253">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="54d3f-254">Per fornire i parametri dinamici, il provider di contenitore deve implementare il [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) (metodo).</span><span class="sxs-lookup"><span data-stu-id="54d3f-254">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="54d3f-255">Questo metodo recupera i parametri per l'elemento nel percorso indicato e restituisce un oggetto che dispone di proprietà e campi con analisi degli attributi simili a una classe cmdlet o una [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) oggetto.</span><span class="sxs-lookup"><span data-stu-id="54d3f-255">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="54d3f-256">Il runtime di Windows PowerShell Usa l'oggetto restituito per aggiungere i parametri di `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-256">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="54d3f-257">Questo provider non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-257">This provider does not implement this method.</span></span> <span data-ttu-id="54d3f-258">Tuttavia, il codice seguente è l'implementazione predefinita di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-258">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="54d3f-259">Rimozione di elementi</span><span class="sxs-lookup"><span data-stu-id="54d3f-259">Removing Items</span></span>

<span data-ttu-id="54d3f-260">Per rimuovere gli elementi, il provider di Windows PowerShell è necessario eseguire l'override di [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) metodo per supportare le chiamate dal `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-260">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="54d3f-261">Questo metodo consente di eliminare un elemento dall'archivio dati nel percorso specificato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-261">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="54d3f-262">Se il `recurse` parametro il `Remove-Item` cmdlet è impostata su `true`, il metodo rimuove tutti gli elementi figlio, indipendentemente dal relativo livello.</span><span class="sxs-lookup"><span data-stu-id="54d3f-262">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="54d3f-263">Se il parametro è impostato su `false`, il metodo rimuove solo un singolo elemento nel percorso specificato.</span><span class="sxs-lookup"><span data-stu-id="54d3f-263">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="54d3f-264">Questo provider non supporta la rimozione di elementi.</span><span class="sxs-lookup"><span data-stu-id="54d3f-264">This provider does not support item removal.</span></span> <span data-ttu-id="54d3f-265">Tuttavia, il codice seguente è l'implementazione predefinita di [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="54d3f-265">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="54d3f-266">Aspetti da ricordare sull'implementazione RemoveItem</span><span class="sxs-lookup"><span data-stu-id="54d3f-266">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="54d3f-267">Le condizioni seguenti possono si applicano all'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="54d3f-267">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="54d3f-268">Quando si definisce la classe del provider, un provider di contenitore di Windows PowerShell potrebbe dichiarare funzionalità del provider di ExpandWildcards, filtro, inclusione o esclusione, dal [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-268">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="54d3f-269">In questi casi, l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) deve garantire che il percorso passato al metodo soddisfi i requisiti della classe specificata (metodo) funzionalità.</span><span class="sxs-lookup"><span data-stu-id="54d3f-269">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="54d3f-270">A tale scopo, il metodo deve accedere alla proprietà appropriata, ad esempio, il [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) proprietà.</span><span class="sxs-lookup"><span data-stu-id="54d3f-270">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="54d3f-271">Per impostazione predefinita, gli override di questo metodo non necessario rimuovere gli oggetti, a meno che il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) viene impostata su true.</span><span class="sxs-lookup"><span data-stu-id="54d3f-271">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="54d3f-272">Se il percorso specificato indica un contenitore, il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) proprietà non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="54d3f-272">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="54d3f-273">L'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) è responsabile del divieto una ricorsione infinita quando sono presenti collegamenti circolari e così via.</span><span class="sxs-lookup"><span data-stu-id="54d3f-273">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="54d3f-274">Un'eccezione di terminazione appropriata deve essere generata in modo da riflettere tale condizione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-274">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="54d3f-275">L'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) metodo deve chiamare [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e controllare il valore restituito corrispondente prima di apportare modifiche all'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="54d3f-275">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="54d3f-276">Dopo la chiamata a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) restituisce `true`, il [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) metodo deve chiamare il [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metodo come un ulteriore controllo per le modifiche del sistema potenzialmente pericolose.</span><span class="sxs-lookup"><span data-stu-id="54d3f-276">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="54d3f-277">Associare i parametri dinamici per il Cmdlet Remove-Item</span><span class="sxs-lookup"><span data-stu-id="54d3f-277">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="54d3f-278">In alcuni casi il `Remove-Item` cmdlet richiede parametri aggiuntivi che vengono specificati in modo dinamico in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-278">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="54d3f-279">Per fornire i parametri dinamici, il provider di contenitore deve implementare il [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) metodo per gestire questi parametri.</span><span class="sxs-lookup"><span data-stu-id="54d3f-279">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="54d3f-280">Questo metodo recupera i parametri dinamici per l'elemento nel percorso indicato e restituisce un oggetto che dispone di proprietà e campi con analisi degli attributi simili a una classe cmdlet o una [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) oggetto.</span><span class="sxs-lookup"><span data-stu-id="54d3f-280">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="54d3f-281">Il runtime di Windows PowerShell Usa l'oggetto restituito per aggiungere i parametri di `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-281">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="54d3f-282">Questo provider di contenitore non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-282">This container provider does not implement this method.</span></span> <span data-ttu-id="54d3f-283">Tuttavia, il codice seguente è l'implementazione predefinita di [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="54d3f-283">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="54d3f-284">L'esecuzione di query per gli elementi figlio</span><span class="sxs-lookup"><span data-stu-id="54d3f-284">Querying for Child Items</span></span>

<span data-ttu-id="54d3f-285">Per verificare se esistono elementi figlio nel percorso specificato, il provider di contenitore di Windows PowerShell è necessario eseguire l'override di [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) (metodo).</span><span class="sxs-lookup"><span data-stu-id="54d3f-285">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="54d3f-286">Questo metodo restituisce `true` se l'elemento dispone di figli, e `false` in caso contrario.</span><span class="sxs-lookup"><span data-stu-id="54d3f-286">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="54d3f-287">Per un percorso null o vuoto, il metodo prende in considerazione tutti gli elementi nell'archivio dati come elementi figlio e restituisce `true`.</span><span class="sxs-lookup"><span data-stu-id="54d3f-287">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="54d3f-288">Ecco l'override per il [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) (metodo).</span><span class="sxs-lookup"><span data-stu-id="54d3f-288">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="54d3f-289">Se sono presenti più di due parti di percorso create dal metodo helper ChunkPath, il metodo restituisce `false`, dal momento che sono definiti solo un contenitore del database e un contenitore della tabella.</span><span class="sxs-lookup"><span data-stu-id="54d3f-289">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="54d3f-290">Per altre informazioni su questo metodo di supporto, vedere il metodo ChunkPath viene illustrato in [creazione di un Provider di Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="54d3f-290">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="54d3f-291">Aspetti da ricordare sull'implementazione HasChildItems</span><span class="sxs-lookup"><span data-stu-id="54d3f-291">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="54d3f-292">Le condizioni seguenti possono si applicano all'implementazione di [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="54d3f-292">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="54d3f-293">Se il contenitore espone una radice che contiene interessanti punti di montaggio, l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) metodo dovrebbe restituire `true`quando un valore null o una stringa vuota viene passata per il percorso.</span><span class="sxs-lookup"><span data-stu-id="54d3f-293">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="54d3f-294">Copia di elementi</span><span class="sxs-lookup"><span data-stu-id="54d3f-294">Copying Items</span></span>

<span data-ttu-id="54d3f-295">Per copiare gli elementi, il provider di contenitore deve implementare il [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) metodo per supportare le chiamate dal `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-295">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="54d3f-296">Questo metodo consente di copiare un elemento di dati dalla posizione indicata dal `path` del cmdlet nel percorso indicato dal parametro di `copyPath` parametro.</span><span class="sxs-lookup"><span data-stu-id="54d3f-296">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="54d3f-297">Se il `recurse` viene specificato, il metodo di copia tutti i contenitori secondari.</span><span class="sxs-lookup"><span data-stu-id="54d3f-297">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="54d3f-298">Se il parametro viene omesso, il metodo di copia un solo livello di elementi.</span><span class="sxs-lookup"><span data-stu-id="54d3f-298">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="54d3f-299">Questo provider non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-299">This provider does not implement this method.</span></span> <span data-ttu-id="54d3f-300">Tuttavia, il codice seguente è l'implementazione predefinita di [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="54d3f-300">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="54d3f-301">Aspetti da ricordare sull'implementazione di CopyItem</span><span class="sxs-lookup"><span data-stu-id="54d3f-301">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="54d3f-302">Le condizioni seguenti possono si applicano all'implementazione di [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="54d3f-302">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="54d3f-303">Quando si definisce la classe del provider, un provider di contenitore di Windows PowerShell potrebbe dichiarare funzionalità del provider di ExpandWildcards, filtro, inclusione o esclusione, dal [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-303">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="54d3f-304">In questi casi, l'implementazione del [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) deve garantire che il percorso passato al metodo soddisfi i requisiti della classe specificata (metodo) funzionalità.</span><span class="sxs-lookup"><span data-stu-id="54d3f-304">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="54d3f-305">A tale scopo, il metodo deve accedere alla proprietà appropriata, ad esempio, il [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) proprietà.</span><span class="sxs-lookup"><span data-stu-id="54d3f-305">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="54d3f-306">Per impostazione predefinita, gli override di questo metodo non necessario copiare gli oggetti tramite gli oggetti esistenti, a meno che il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) è impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="54d3f-306">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="54d3f-307">Ad esempio, il provider FileSystem non copierà c:\temp\abc.txt tramite un file esistente c:\abc.txt a meno che non la [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) è impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="54d3f-307">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="54d3f-308">Se il percorso specificato nella `copyPath` parametro è presente e indica un contenitore, il [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) proprietà non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="54d3f-308">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="54d3f-309">In questo caso, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) deve copiare l'elemento indicato dalle `path` parametro per il contenitore indicato dal `copyPath` parametro come elemento figlio.</span><span class="sxs-lookup"><span data-stu-id="54d3f-309">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="54d3f-310">L'implementazione di [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) è responsabile del divieto una ricorsione infinita quando sono presenti collegamenti circolari e così via.</span><span class="sxs-lookup"><span data-stu-id="54d3f-310">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="54d3f-311">Un'eccezione di terminazione appropriata deve essere generata in modo da riflettere tale condizione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-311">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="54d3f-312">L'implementazione del [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) metodo deve chiamare [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e controllare il valore restituito corrispondente prima di apportare modifiche all'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="54d3f-312">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="54d3f-313">Dopo la chiamata a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) restituisce true, il [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) il metodo deve chiamare il [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metodo come un ulteriore controllo per le modifiche del sistema potenzialmente pericolose.</span><span class="sxs-lookup"><span data-stu-id="54d3f-313">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="54d3f-314">Per altre informazioni sulla chiamata di questi metodi, vedere [rinominare elementi](#Renaming-Items).</span><span class="sxs-lookup"><span data-stu-id="54d3f-314">For more information about calling these methods, see [Rename Items](#Renaming-Items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="54d3f-315">Associare i parametri dinamici per il Cmdlet Copy-Item</span><span class="sxs-lookup"><span data-stu-id="54d3f-315">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="54d3f-316">In alcuni casi il `Copy-Item` cmdlet richiede parametri aggiuntivi che vengono specificati in modo dinamico in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="54d3f-316">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="54d3f-317">Per fornire i parametri dinamici, il provider di contenitore di Windows PowerShell deve implementare il [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) gestire queste (metodo) parametri.</span><span class="sxs-lookup"><span data-stu-id="54d3f-317">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="54d3f-318">Questo metodo recupera i parametri per l'elemento nel percorso indicato e restituisce un oggetto che dispone di proprietà e campi con analisi degli attributi simili a una classe cmdlet o una [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) oggetto.</span><span class="sxs-lookup"><span data-stu-id="54d3f-318">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="54d3f-319">Il runtime di Windows PowerShell Usa l'oggetto restituito per aggiungere i parametri di `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="54d3f-319">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="54d3f-320">Questo provider non implementa questo metodo.</span><span class="sxs-lookup"><span data-stu-id="54d3f-320">This provider does not implement this method.</span></span> <span data-ttu-id="54d3f-321">Tuttavia, il codice seguente è l'implementazione predefinita di [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="54d3f-321">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="54d3f-322">Esempio di codice</span><span class="sxs-lookup"><span data-stu-id="54d3f-322">Code Sample</span></span>

<span data-ttu-id="54d3f-323">Per il codice di esempio completo, vedere [esempio di codice AccessDbProviderSample04](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="54d3f-323">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="54d3f-324">Creazione del Provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-324">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="54d3f-325">Visualizzare [come registrare i cmdlet, provider e ospitare applicazioni](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="54d3f-325">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="54d3f-326">Test di un Provider Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-326">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="54d3f-327">Quando il provider di Windows PowerShell è stato registrato con Windows PowerShell, è possibile eseguirne il test eseguendo il cmdlet supportati nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="54d3f-327">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="54d3f-328">Tenere presente che l'output di esempio seguente usa un database di Access fittizio.</span><span class="sxs-lookup"><span data-stu-id="54d3f-328">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="54d3f-329">Eseguire il `Get-ChildItem` cmdlet per recuperare l'elenco degli elementi figlio da una tabella Customers nel database di Access.</span><span class="sxs-lookup"><span data-stu-id="54d3f-329">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="54d3f-330">Viene visualizzato l'output seguente.</span><span class="sxs-lookup"><span data-stu-id="54d3f-330">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="54d3f-331">Eseguire il `Get-ChildItem` cmdlet per recuperare i dati di una tabella.</span><span class="sxs-lookup"><span data-stu-id="54d3f-331">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="54d3f-332">Viene visualizzato l'output seguente.</span><span class="sxs-lookup"><span data-stu-id="54d3f-332">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="54d3f-333">A questo punto usare il `Get-Item` cmdlet per recuperare gli elementi alla riga 0 nella tabella dati.</span><span class="sxs-lookup"><span data-stu-id="54d3f-333">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="54d3f-334">Viene visualizzato l'output seguente.</span><span class="sxs-lookup"><span data-stu-id="54d3f-334">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="54d3f-335">Riutilizzare `Get-Item` per recuperare i dati per gli elementi nella riga 0.</span><span class="sxs-lookup"><span data-stu-id="54d3f-335">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="54d3f-336">Viene visualizzato l'output seguente.</span><span class="sxs-lookup"><span data-stu-id="54d3f-336">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="54d3f-337">A questo punto usare il `New-Item` cmdlet per aggiungere una riga a una tabella esistente.</span><span class="sxs-lookup"><span data-stu-id="54d3f-337">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="54d3f-338">Il `Path` parametro specifica il percorso completo alla riga e deve indicare un numero di riga che è maggiore del numero di righe nella tabella esistente.</span><span class="sxs-lookup"><span data-stu-id="54d3f-338">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="54d3f-339">Il `Type` parametro indica "riga" per specificare che il tipo di elemento da aggiungere.</span><span class="sxs-lookup"><span data-stu-id="54d3f-339">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="54d3f-340">Infine, il `Value` parametro specifica un elenco delimitato da virgole di valori di colonna per la riga.</span><span class="sxs-lookup"><span data-stu-id="54d3f-340">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="54d3f-341">Verificare la correttezza della nuova operazione di elemento come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="54d3f-341">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="54d3f-342">Viene visualizzato l'output seguente.</span><span class="sxs-lookup"><span data-stu-id="54d3f-342">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="54d3f-343">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="54d3f-343">See Also</span></span>

[<span data-ttu-id="54d3f-344">Creazione di provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-344">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="54d3f-345">Progettazione del Provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-345">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="54d3f-346">Implementazione di un Provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-346">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="54d3f-347">Implementazione di un Provider di navigazione Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-347">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="54d3f-348">Come registrare i cmdlet, provider e applicazioni Host</span><span class="sxs-lookup"><span data-stu-id="54d3f-348">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="54d3f-349">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="54d3f-349">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="54d3f-350">Guida per programmatori di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d3f-350">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)