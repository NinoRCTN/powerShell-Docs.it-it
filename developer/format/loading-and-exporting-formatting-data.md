---
title: Il caricamento e l'esportazione di dati di formattazione | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2a48de31-7961-4b0e-b58b-93466e38370b
caps.latest.revision: 6
ms.openlocfilehash: 5c5168ffd74c15066b914ad1b39d9ead947c5e7f
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2019
ms.locfileid: "62065207"
---
# <a name="loading-and-exporting-formatting-data"></a><span data-ttu-id="42414-102">Caricamento ed esportazione di dati di formattazione</span><span class="sxs-lookup"><span data-stu-id="42414-102">Loading and Exporting Formatting Data</span></span>

<span data-ttu-id="42414-103">Dopo aver creato il file di formattazione, è necessario aggiornare i dati di formato della sessione mediante il caricamento dei file nella sessione corrente.</span><span class="sxs-lookup"><span data-stu-id="42414-103">Once you have created your formatting file, you need to update the format data of the session by loading your files into the current session.</span></span> <span data-ttu-id="42414-104">(I file di formattazione forniti da Windows PowerShell vengono caricati dagli snap-in registrati quando viene aperta la sessione corrente). Dopo aver aggiornati i dati in formato della sessione corrente, Windows PowerShell Usa tali dati per visualizzare gli oggetti .NET associati con le visualizzazioni definite nei file di formattazione caricati.</span><span class="sxs-lookup"><span data-stu-id="42414-104">(The formatting files provided by Windows PowerShell are loaded by snap-ins that are registered when the current session is opened.) Once the format data of the current session is updated, Windows PowerShell uses that data to display the .NET objects associated with the views defined in the loaded formatting files.</span></span> <span data-ttu-id="42414-105">Non sono previsti limiti al numero di file di formattazione che è possibile caricare nella sessione corrente.</span><span class="sxs-lookup"><span data-stu-id="42414-105">There is no limit to the number of formatting files that you can load into the current session.</span></span> <span data-ttu-id="42414-106">Oltre ad aggiornare i dati di formattazione, è possibile esportare i dati di formattazione nella sessione corrente in un file di formattazione.</span><span class="sxs-lookup"><span data-stu-id="42414-106">In addition to updating the formatting data, you can export the format data in the current session back to a formatting file.</span></span>

## <a name="loading-format-data"></a><span data-ttu-id="42414-107">Il caricamento dei dati di formato</span><span class="sxs-lookup"><span data-stu-id="42414-107">Loading format data</span></span>

<span data-ttu-id="42414-108">È possibile caricare i file di formattazione nella sessione corrente usando i metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="42414-108">Formatting files can be loaded into the current session using the following methods:</span></span>

- <span data-ttu-id="42414-109">È possibile importare il file di formattazione nella sessione corrente dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="42414-109">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="42414-110">Usare la [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, come descritto nella procedura seguente.</span><span class="sxs-lookup"><span data-stu-id="42414-110">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>

- <span data-ttu-id="42414-111">È possibile creare un manifesto del modulo che fa riferimento a file di formattazione.</span><span class="sxs-lookup"><span data-stu-id="42414-111">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="42414-112">I moduli consentono di formattare i file per la distribuzione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="42414-112">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="42414-113">Usare la [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) per creare il manifesto e il [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet per caricare il modulo nella sessione corrente.</span><span class="sxs-lookup"><span data-stu-id="42414-113">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="42414-114">Per altre informazioni sui moduli, vedere [scrittura di un modulo di Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="42414-114">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="42414-115">È possibile creare uno snap-in che fa riferimento a file di formattazione.</span><span class="sxs-lookup"><span data-stu-id="42414-115">You can create a snap-in that references your formatting file.</span></span> <span data-ttu-id="42414-116">Usare la [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) fare riferimento ai file di formattazione.</span><span class="sxs-lookup"><span data-stu-id="42414-116">Use the [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) to reference your formatting files.</span></span> <span data-ttu-id="42414-117">È consigliabile utilizzare i moduli per i cmdlet di pacchetto e qualsiasi formattazione associati e file di tipi per la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="42414-117">It is strongly encouraged to use modules to package cmdlets, and any associated formatting and types files for distribution.</span></span> <span data-ttu-id="42414-118">Per altre informazioni sui moduli, vedere [scrittura di un modulo di Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="42414-118">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="42414-119">Se si richiamano comandi a livello di codice, è possibile aggiungere una voce del file di formattazione per lo stato sessione iniziale di spazio di esecuzione in cui vengono eseguiti i comandi.</span><span class="sxs-lookup"><span data-stu-id="42414-119">If you are invoking commands programmatically, you can add a formatting file entry to the initial session state of the runspace where the commands are run.</span></span> <span data-ttu-id="42414-120">Per altre informazioni sul tipo di .NET usata per aggiungere il file di formattazione, vedere il [System.Management.Automation.Runspaces.Sessionstateformatentry? Displayproperty = Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) classe.</span><span class="sxs-lookup"><span data-stu-id="42414-120">For more information about .NET type used to add the formatting file, see the [System.Management.Automation.Runspaces.Sessionstateformatentry?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) class.</span></span>

<span data-ttu-id="42414-121">Quando viene caricato un file di formattazione, viene aggiunto a un elenco interno che Windows PowerShell utilizza per determinare quale visualizzazione da utilizzare per la visualizzazione di oggetti dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="42414-121">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="42414-122">È possibile anteporre il file di formattazione all'inizio dell'elenco, oppure è possibile aggiungerlo alla fine dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="42414-122">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="42414-123">Conoscendo in cui i file di formattazione viene aggiunto a questo elenco è importante se si sta caricando file di formattazione che definisce una visualizzazione per un oggetto che dispone di una vista esistente definita, ad esempio quando si desidera modificare la modalità è un oggetto restituito da un cmdlet di Windows PowerShell core  visualizzato.</span><span class="sxs-lookup"><span data-stu-id="42414-123">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="42414-124">Se si sta caricando un file di formattazione che definisce la vista sola per un oggetto, è possibile usare uno qualsiasi dei metodi descritti in precedenza.</span><span class="sxs-lookup"><span data-stu-id="42414-124">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="42414-125">Se si sta caricando un file di formattazione che definisce un'altra visualizzazione per un oggetto, è necessario usare il [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet e anteporre il file all'inizio dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="42414-125">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>

## <a name="storing-your-formatting-file"></a><span data-ttu-id="42414-126">L'archiviazione File di formattazione</span><span class="sxs-lookup"><span data-stu-id="42414-126">Storing Your Formatting File</span></span>

<span data-ttu-id="42414-127">Non vi è alcun requisito per cui sono archiviati i file di formattazione su disco.</span><span class="sxs-lookup"><span data-stu-id="42414-127">There is no requirement for where your formatting files are stored on disk.</span></span> <span data-ttu-id="42414-128">Tuttavia, è consigliabile archiviarle nella cartella seguente: `user\documents\windowspowershell\`</span><span class="sxs-lookup"><span data-stu-id="42414-128">However, it is strongly suggested that you store them in the following folder: `user\documents\windowspowershell\`</span></span>

#### <a name="loading-a-format-file-using-import-formatdata"></a><span data-ttu-id="42414-129">Il caricamento di un file di formato tramite importazione-FormatData</span><span class="sxs-lookup"><span data-stu-id="42414-129">Loading a format file using Import-FormatData</span></span>

1. <span data-ttu-id="42414-130">Store il file di formattazione su disco.</span><span class="sxs-lookup"><span data-stu-id="42414-130">Store your formatting file to disk.</span></span>

2. <span data-ttu-id="42414-131">Eseguire la [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet usando uno dei comandi seguenti.</span><span class="sxs-lookup"><span data-stu-id="42414-131">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>

   <span data-ttu-id="42414-132">Per aggiungere la formattazione file all'inizio dell'elenco di utilizzare questo comando.</span><span class="sxs-lookup"><span data-stu-id="42414-132">To add your formatting file to the front of the list use this command.</span></span> <span data-ttu-id="42414-133">Usare questo comando se si modifica la modalità di visualizzazione di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="42414-133">Use this command if you are changing how an object is displayed.</span></span>

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   <span data-ttu-id="42414-134">Per aggiungere la formattazione file alla fine dell'elenco di utilizzare questo comando.</span><span class="sxs-lookup"><span data-stu-id="42414-134">To add your formatting file to the end of the list use this command.</span></span>

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   <span data-ttu-id="42414-135">Dopo aver aggiunto un file usando il [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, è possibile rimuovere il file dall'elenco mentre è aperta la sessione.</span><span class="sxs-lookup"><span data-stu-id="42414-135">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="42414-136">È necessario chiudere la sessione per rimuovere il file di formattazione dall'elenco.</span><span class="sxs-lookup"><span data-stu-id="42414-136">You must close the session to remove the formatting file from the list.</span></span>

## <a name="exporting-format-data"></a><span data-ttu-id="42414-137">Esportazione dei dati di formato</span><span class="sxs-lookup"><span data-stu-id="42414-137">Exporting format data</span></span>

<span data-ttu-id="42414-138">Inserire qui il corpo della sezione.</span><span class="sxs-lookup"><span data-stu-id="42414-138">Insert section body here.</span></span>
