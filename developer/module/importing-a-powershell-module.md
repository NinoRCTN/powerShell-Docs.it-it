---
title: Importazione di un modulo di PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 697791b3-2135-4a39-b9d7-8566ed67acf2
caps.latest.revision: 13
ms.openlocfilehash: bb5d036e5658c365a4fafa2cac05c0bba9f87019
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/03/2019
ms.locfileid: "56854057"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="5b129-102">Importazione di un modulo di PowerShell</span><span class="sxs-lookup"><span data-stu-id="5b129-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="5b129-103">Una volta di aver installato un modulo in un sistema, è opportuno importare il modulo.</span><span class="sxs-lookup"><span data-stu-id="5b129-103">Once your have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="5b129-104">L'importazione è il processo che carica il modulo in memoria attiva, in modo che un utente può accedere a tale modulo nella sessione di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="5b129-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="5b129-105">In PowerShell 2.0, è possibile importare un modulo di PowerShell appena installato con una chiamata a [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="5b129-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="5b129-106">In PowerShell 3.0, PowerShell è in grado di importare in modo implicito un modulo quando una delle funzioni o cmdlet nel modulo viene chiamata da un utente.</span><span class="sxs-lookup"><span data-stu-id="5b129-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="5b129-107">Si noti che entrambe le versioni si supponga di installa un modulo in una posizione in cui è in grado di trovarlo; PowerShell per altre informazioni, vedere [installazione di un modulo di PowerShell](./installing-a-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="5b129-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span> <span data-ttu-id="5b129-108">È possibile usare un manifesto del modulo per limitare le parti del modulo vengono esportate ed è possibile usare parametri del `Import-Module` chiamate per limitare quali parti vengono importate.</span><span class="sxs-lookup"><span data-stu-id="5b129-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="5b129-109">L'importazione di uno Snap-In (PowerShell 1.0)</span><span class="sxs-lookup"><span data-stu-id="5b129-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="5b129-110">I moduli non esisteva in PowerShell 1.0: al contrario, era necessario registrare e usare gli snap-in. Tuttavia, si consiglia di non a questo punto, si utilizza questa tecnologia come i moduli vengono in genere più semplici installare e importare.</span><span class="sxs-lookup"><span data-stu-id="5b129-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="5b129-111">Per altre informazioni, vedere [come creare uno Snap-in PowerShell di Windows](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="5b129-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="5b129-112">Importazione di un modulo con Import-Module (PowerShell 2.0)</span><span class="sxs-lookup"><span data-stu-id="5b129-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="5b129-113">PowerShell 2.0 viene utilizzato l'oggetto denominato in modo appropriato [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) per importare i moduli.</span><span class="sxs-lookup"><span data-stu-id="5b129-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="5b129-114">Quando si esegue questo cmdlet, Windows PowerShell cerca il modulo specificato all'interno delle directory specificate nel `PSModulePath` variabile.</span><span class="sxs-lookup"><span data-stu-id="5b129-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="5b129-115">Quando viene trovata nella directory specificata, Windows PowerShell cerca i file nell'ordine seguente: i file manifesto del modulo (con estensione psd1), modulo i file script (psm1), file del modulo binario (DLL).</span><span class="sxs-lookup"><span data-stu-id="5b129-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="5b129-116">Per altre informazioni sull'aggiunta di directory per la ricerca, vedere [modifica il percorso di installazione di PSModulePath](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="5b129-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span> <span data-ttu-id="5b129-117">Il codice seguente viene descritto come importare un modulo:</span><span class="sxs-lookup"><span data-stu-id="5b129-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="5b129-118">Supponendo che è accessibile da myModule il `PSModulePath`, PowerShell carica myModule nella memoria attiva.</span><span class="sxs-lookup"><span data-stu-id="5b129-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="5b129-119">Se myModule non si trova su un `PSModulePath` percorso, si potrebbe comunque indicare in modo esplicito PowerShell dove si trovano:</span><span class="sxs-lookup"><span data-stu-id="5b129-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="5b129-120">È anche possibile usare il parametro - verbose per identificare ciò che viene esportata all'esterno del modulo e cosa viene importato nella memoria attiva.</span><span class="sxs-lookup"><span data-stu-id="5b129-120">You can also use the -verbose parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="5b129-121">Le esportazioni e importazioni limitano ciò che viene esposto all'utente: la differenza è che controlla la visibilità.</span><span class="sxs-lookup"><span data-stu-id="5b129-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="5b129-122">In pratica, le esportazioni sono controllate dal codice all'interno del modulo.</span><span class="sxs-lookup"><span data-stu-id="5b129-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="5b129-123">Al contrario, le importazioni sono controllate dal `Import-Module` chiamare.</span><span class="sxs-lookup"><span data-stu-id="5b129-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="5b129-124">Per altre informazioni, vedere **limitando i membri che vengono importati**riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="5b129-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="5b129-125">In modo implicito l'importazione di un modulo (PowerShell 3.0)</span><span class="sxs-lookup"><span data-stu-id="5b129-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="5b129-126">A partire da Windows PowerShell 3.0, moduli vengono importati automaticamente quando qualsiasi cmdlet o funzione nel modulo viene usato in un comando.</span><span class="sxs-lookup"><span data-stu-id="5b129-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="5b129-127">Questa funzionalità funziona in tutti i moduli in una directory inclusi nel valore della **PSModulePath** variabile di ambiente.</span><span class="sxs-lookup"><span data-stu-id="5b129-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="5b129-128">Se non si salva un modulo in un percorso UNC valido, tuttavia, è comunque possibile caricare tramite l'impostazione esplicita [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) opzione, descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="5b129-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="5b129-129">Le azioni seguenti attivano l'importazione automatica di un modulo, noto anche come "modulo auto-caricamento."</span><span class="sxs-lookup"><span data-stu-id="5b129-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="5b129-130">Usare un cmdlet in un comando.</span><span class="sxs-lookup"><span data-stu-id="5b129-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="5b129-131">Ad esempio, se si digita `Get-ExecutionPolicy` Importa il modulo Security che contiene il `Get-ExecutionPolicy` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="5b129-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="5b129-132">Usando il [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) per ottenere il comando.</span><span class="sxs-lookup"><span data-stu-id="5b129-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span>  <span data-ttu-id="5b129-133">Ad esempio, se si digita `Get-Command Get-JobTrigger` Importa i **PSScheduledJob** modulo che contiene il `Get-JobTrigger` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="5b129-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="5b129-134">Oggetto `Get-Command` comando che include caratteri jolly è considerato individuazione e non attiva l'importazione di un modulo.</span><span class="sxs-lookup"><span data-stu-id="5b129-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="5b129-135">Usando il [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet per ottenere assistenza per un cmdlet.</span><span class="sxs-lookup"><span data-stu-id="5b129-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="5b129-136">Ad esempio, se si digita `Get-Help Get-WinEvent` Importa il modulo Microsoft.PowerShell.Diagnostics che contiene il `Get-WinEvent` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="5b129-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="5b129-137">Per supportare l'importazione automatica dei moduli, i `Get-Command` cmdlet recupera tutti i cmdlet e funzioni in tutti i moduli installati, anche se il modulo non viene importato nella sessione.</span><span class="sxs-lookup"><span data-stu-id="5b129-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="5b129-138">Per altre informazioni, vedere l'argomento della Guida per la [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="5b129-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="5b129-139">Il processo di importazione</span><span class="sxs-lookup"><span data-stu-id="5b129-139">The Importing Process</span></span>

<span data-ttu-id="5b129-140">Quando si importa un modulo, lo stato di una nuova sessione viene creato per il modulo e un [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) viene creato l'oggetto in memoria.</span><span class="sxs-lookup"><span data-stu-id="5b129-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="5b129-141">Uno stato di sessione viene creato per ogni modulo importato (che include il modulo radice e tutti i moduli annidati).</span><span class="sxs-lookup"><span data-stu-id="5b129-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="5b129-142">I membri esportati dal modulo radice, inclusi tutti i membri che sono stati esportati per il modulo radice per tutti i moduli annidati, vengono quindi importati nello stato sessione del chiamante.</span><span class="sxs-lookup"><span data-stu-id="5b129-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="5b129-143">I metadati dei membri che sono esportate da un modulo dispone di una proprietà ModuleName.</span><span class="sxs-lookup"><span data-stu-id="5b129-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="5b129-144">Questa proprietà viene popolata con il nome del modulo che li esportato.</span><span class="sxs-lookup"><span data-stu-id="5b129-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="5b129-145">Se il nome di un membro esportato viene usato un verbo non approvato o se il nome del membro utilizza caratteri non consentiti, viene visualizzato un avviso quando la [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="5b129-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="5b129-146">Per impostazione predefinita, il [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet non restituisce tutti gli oggetti alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="5b129-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="5b129-147">Tuttavia, il cmdlet supporta una `PassThru` parametro che può essere usato per restituire un [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) oggetto per ogni modulo importato.</span><span class="sxs-lookup"><span data-stu-id="5b129-147">However, the cmdlet supports a `PassThru` parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="5b129-148">Per inviare l'output all'host, gli utenti devono eseguire la [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="5b129-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="5b129-149">Limitare i membri che vengono importati</span><span class="sxs-lookup"><span data-stu-id="5b129-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="5b129-150">Durante l'importazione di un modulo tramite il [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, per impostazione predefinita, tutti i moduli esportati i membri vengono importati nella sessione, inclusi tutti i comandi esportati per il modulo da un modulo annidato.</span><span class="sxs-lookup"><span data-stu-id="5b129-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="5b129-151">Per impostazione predefinita, le variabili e alias non vengono esportate.</span><span class="sxs-lookup"><span data-stu-id="5b129-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="5b129-152">Per limitare i membri esportati, usare una [manifesto del modulo](./how-to-write-a-powershell-module-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="5b129-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span> <span data-ttu-id="5b129-153">Per limitare i membri che vengono importati, usare i parametri seguenti del `Import-Module` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="5b129-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="5b129-154">`Function`: Questo parametro consente di limitare le funzioni esportate.</span><span class="sxs-lookup"><span data-stu-id="5b129-154">`Function`: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="5b129-155">(Se si utilizza un manifesto del modulo, vedere la chiave FunctionsToExport).</span><span class="sxs-lookup"><span data-stu-id="5b129-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="5b129-156">`Cmdlet`: Questo parametro limita i cmdlet esportati (se si è mediante un modulo manifesto, vedere la chiave CmdletsToExport.)</span><span class="sxs-lookup"><span data-stu-id="5b129-156">`Cmdlet`: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="5b129-157">`Variable`: Questo parametro limita le variabili esportate (se si è mediante un modulo manifesto, vedere la chiave VariablesToExport.)</span><span class="sxs-lookup"><span data-stu-id="5b129-157">`Variable`: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="5b129-158">`Alias`: Questo parametro limita gli alias esportati (se si è mediante un modulo manifesto, vedere la chiave AliasesToExport.)</span><span class="sxs-lookup"><span data-stu-id="5b129-158">`Alias`: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="5b129-159">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="5b129-159">See Also</span></span>

[<span data-ttu-id="5b129-160">Scrittura di un modulo di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="5b129-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
