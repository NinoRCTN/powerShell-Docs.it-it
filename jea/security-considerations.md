---
ms.date: 06/12/2017
keywords: jea,powershell,sicurezza
title: Considerazioni sulla sicurezza in JEA
ms.openlocfilehash: 46ea5cc3e9bc7b6759524aa466e900950a6dee26
ms.sourcegitcommit: 54534635eedacf531d8d6344019dc16a50b8b441
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 05/16/2018
---
# <a name="jea-security-considerations"></a><span data-ttu-id="3cde5-103">Considerazioni sulla sicurezza in JEA</span><span class="sxs-lookup"><span data-stu-id="3cde5-103">JEA Security Considerations</span></span>

> <span data-ttu-id="3cde5-104">Si applica a: Windows PowerShell 5.0</span><span class="sxs-lookup"><span data-stu-id="3cde5-104">Applies to: Windows PowerShell 5.0</span></span>

<span data-ttu-id="3cde5-105">JEA consente di migliorare le condizioni di sicurezza, riducendo il numero di amministratori permanenti nei computer.</span><span class="sxs-lookup"><span data-stu-id="3cde5-105">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span>
<span data-ttu-id="3cde5-106">Ciò avviene tramite la creazione per gli utenti di un nuovo punto di ingresso per gestire il sistema (con una configurazione sessione PowerShell) saldamente bloccato per impostazione predefinita per prevenire usi impropri.</span><span class="sxs-lookup"><span data-stu-id="3cde5-106">It does so by creating a new entry point for users to manage the system (a PowerShell session configuration) which is tightly locked down by default to prevent misuse.</span></span>
<span data-ttu-id="3cde5-107">Agli utenti che richiedono un accesso non illimitato al computer per eseguire attività amministrative è possibile concedere l'accesso all'endpoint JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-107">Users who need some, but not unlimited, access to the machine to perform administrative tasks can be granted access to the JEA endpoint.</span></span>
<span data-ttu-id="3cde5-108">Poiché JEA consente di eseguire i comandi di amministratore senza avere accesso come amministratore, è quindi possibile rimuovere utenti da gruppi di sicurezza con privilegi elevati (renderli quindi utenti standard).</span><span class="sxs-lookup"><span data-stu-id="3cde5-108">Because JEA allows them to run admin commands without directly having admin access, you can then remove those users from highly privileged security groups (make them standard users).</span></span>

<span data-ttu-id="3cde5-109">Questo argomento illustra in modo più dettagliato il modello di sicurezza in JEA e le procedure consigliate.</span><span class="sxs-lookup"><span data-stu-id="3cde5-109">This topic describes the JEA security model and best practices in more detail.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="3cde5-110">account RunAs</span><span class="sxs-lookup"><span data-stu-id="3cde5-110">Run As account</span></span>

<span data-ttu-id="3cde5-111">Ogni endpoint JEA ha un account designato "RunAs", ovvero l'account con cui vengono eseguite le azioni dall'utente che si connette.</span><span class="sxs-lookup"><span data-stu-id="3cde5-111">Each JEA endpoint has a designated "run as" account, which is the account under which the connecting user's actions are performed.</span></span>
<span data-ttu-id="3cde5-112">Questo account è configurabile nel [file di configurazione sessione](session-configurations.md), e l'account scelto ha un impatto significativo sulla sicurezza dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="3cde5-112">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="3cde5-113">Il modo consigliato per configurare l'account RunAs è usare gli **account virtuali**.</span><span class="sxs-lookup"><span data-stu-id="3cde5-113">**Virtual accounts** are the recommended way of configuring the run as account.</span></span>
<span data-ttu-id="3cde5-114">Gli account virtuali sono account locali temporanei creati per l'utente che si connette e possono essere usati solo per la durata della sessione JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-114">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span>
<span data-ttu-id="3cde5-115">Dopo aver terminato la sessione, l'account virtuale verrà eliminato e non può più essere usato.</span><span class="sxs-lookup"><span data-stu-id="3cde5-115">As soon as their session is terminated, the virtual account will be destroyed and cannot be used anymore.</span></span>
<span data-ttu-id="3cde5-116">L'utente che si connette non conosce le credenziali dell'account virtuale e non può usare l'account virtuale per accedere al sistema tramite altri mezzi, ad esempio Desktop remoto o un endpoint di PowerShell non vincolato.</span><span class="sxs-lookup"><span data-stu-id="3cde5-116">The connecting user does not know the credentials for the virtual account and cannot use the virtual account to access the system via other means, such as Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="3cde5-117">Per impostazione predefinita, gli account virtuali appartengono al gruppo Administrators locale del computer.</span><span class="sxs-lookup"><span data-stu-id="3cde5-117">By default, virtual accounts belong to the local administrators group on the machine.</span></span>
<span data-ttu-id="3cde5-118">Per questo motivo, hanno diritti completi per gestire qualsiasi elemento nel sistema, ma non possono gestire le risorse della rete.</span><span class="sxs-lookup"><span data-stu-id="3cde5-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="3cde5-119">Durante l'autenticazione con altri computer, il contesto utente sarà l'account del computer locale, non l'account virtuale.</span><span class="sxs-lookup"><span data-stu-id="3cde5-119">When authenticating with other machines, the user context will be that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="3cde5-120">I controller di dominio rappresentano un caso speciale, perché non esiste il concetto di gruppo di amministratori locali.</span><span class="sxs-lookup"><span data-stu-id="3cde5-120">Domain controllers are a special case since there is no concept of a local administrators group.</span></span>
<span data-ttu-id="3cde5-121">Gli account virtuali appartengono invece al gruppo Domain Admins e possono gestire i servizi directory nel controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="3cde5-121">Instead, virtual accounts belong to Domain Admins instead and can manage the directory services on the domain controller.</span></span>
<span data-ttu-id="3cde5-122">L'identità di dominio è ancora limitata all'uso nel controller di dominio in cui è stata creata la sessione di JEA e qualsiasi accesso alla rete risulterà invece proveniente dall'oggetto computer del controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="3cde5-122">The domain identity is still restricted to use on the domain controller where the JEA session was instantiated, and any network access will appear to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="3cde5-123">In entrambi i casi, è anche possibile definire in modo esplicito a quale gruppo di sicurezza deve appartenere l'account virtuale.</span><span class="sxs-lookup"><span data-stu-id="3cde5-123">In both cases, you can also explicitly define which security groups the virtual account should belong to.</span></span>
<span data-ttu-id="3cde5-124">Questa è una procedura efficace se l'attività può essere eseguita senza privilegi di amministratore locale o di dominio.</span><span class="sxs-lookup"><span data-stu-id="3cde5-124">This is a good practice when the task you are performing can be done without local/domain admin privileges.</span></span>
<span data-ttu-id="3cde5-125">Se è già disponibile un gruppo di sicurezza definito per gli amministratori, è possibile concedere l'appartenenza dell'account virtuale a tale gruppo per assegnare le autorizzazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="3cde5-125">If you already have a security group defined for your admins, you can simply grant the virtual account membership to that group to give it the permissions it needs.</span></span>
<span data-ttu-id="3cde5-126">L'appartenenza al gruppo account virtuale è limitato a gruppi di sicurezza locali nella workstation e nei server membri, ma in un controller di dominio gli account virtuali possono essere solo membri di gruppi di sicurezza di dominio.</span><span class="sxs-lookup"><span data-stu-id="3cde5-126">Virtual account group membership is limited to local security groups on workstation and member servers, but on a domain controller they can only be members of domain security groups.</span></span>
<span data-ttu-id="3cde5-127">Quando si specificano uno o più gruppi di sicurezza, l'account virtuale non apparterrà più ai gruppi predefiniti (amministratore locale o di dominio).</span><span class="sxs-lookup"><span data-stu-id="3cde5-127">Once you specify one or more security groups for the virtual account to belong to, it will no longer belong to the default groups (local admin or domain admin).</span></span>

<span data-ttu-id="3cde5-128">La tabella seguente illustra le opzioni di configurazione possibili e le autorizzazioni risultanti per gli account virtuali</span><span class="sxs-lookup"><span data-stu-id="3cde5-128">The table below summarizes the possible configuration options and resulting permissions for virtual accounts</span></span>

<span data-ttu-id="3cde5-129">Tipo di computer</span><span class="sxs-lookup"><span data-stu-id="3cde5-129">Computer type</span></span>                | <span data-ttu-id="3cde5-130">Configurazione del gruppo di account virtuali</span><span class="sxs-lookup"><span data-stu-id="3cde5-130">Virtual account group configuration</span></span> | <span data-ttu-id="3cde5-131">Contesto dell'utente locale</span><span class="sxs-lookup"><span data-stu-id="3cde5-131">Local user context</span></span>                                      | <span data-ttu-id="3cde5-132">Contesto dell'utente di rete</span><span class="sxs-lookup"><span data-stu-id="3cde5-132">Network user context</span></span>
-----------------------------|-------------------------------------|---------------------------------------------------------|--------------------------------------------------
<span data-ttu-id="3cde5-133">Controller di dominio</span><span class="sxs-lookup"><span data-stu-id="3cde5-133">Domain controller</span></span>            | <span data-ttu-id="3cde5-134">Default</span><span class="sxs-lookup"><span data-stu-id="3cde5-134">Default</span></span>                             | <span data-ttu-id="3cde5-135">Utente di dominio, membro di "*DOMAIN*\Domain Admins"</span><span class="sxs-lookup"><span data-stu-id="3cde5-135">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="3cde5-136">Account del computer</span><span class="sxs-lookup"><span data-stu-id="3cde5-136">Computer account</span></span>
<span data-ttu-id="3cde5-137">Controller di dominio</span><span class="sxs-lookup"><span data-stu-id="3cde5-137">Domain controller</span></span>            | <span data-ttu-id="3cde5-138">Gruppi di dominio A e B</span><span class="sxs-lookup"><span data-stu-id="3cde5-138">Domain groups A and B</span></span>               | <span data-ttu-id="3cde5-139">Utente di dominio, membro di "*DOMAIN*\A", "*DOMAIN*\B"</span><span class="sxs-lookup"><span data-stu-id="3cde5-139">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="3cde5-140">Account del computer</span><span class="sxs-lookup"><span data-stu-id="3cde5-140">Computer account</span></span>
<span data-ttu-id="3cde5-141">Workstation o server membro</span><span class="sxs-lookup"><span data-stu-id="3cde5-141">Member server or workstation</span></span> | <span data-ttu-id="3cde5-142">Default</span><span class="sxs-lookup"><span data-stu-id="3cde5-142">Default</span></span>                             | <span data-ttu-id="3cde5-143">Utente locale, membro di "*BUILTIN*\Administrators"</span><span class="sxs-lookup"><span data-stu-id="3cde5-143">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="3cde5-144">Account del computer</span><span class="sxs-lookup"><span data-stu-id="3cde5-144">Computer account</span></span>
<span data-ttu-id="3cde5-145">Workstation o server membro</span><span class="sxs-lookup"><span data-stu-id="3cde5-145">Member server or workstation</span></span> | <span data-ttu-id="3cde5-146">Gruppi locali C e D</span><span class="sxs-lookup"><span data-stu-id="3cde5-146">Local groups C and D</span></span>                | <span data-ttu-id="3cde5-147">Utente locale, membro di "*COMPUTER*\C" e "*COMPUTER*\D"</span><span class="sxs-lookup"><span data-stu-id="3cde5-147">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="3cde5-148">Account del computer</span><span class="sxs-lookup"><span data-stu-id="3cde5-148">Computer account</span></span>

<span data-ttu-id="3cde5-149">Quando si esaminano gli eventi del controllo di sicurezza e i log eventi dell'applicazione, si noterà che ogni sessione utente JEA ha un account virtuale univoco.</span><span class="sxs-lookup"><span data-stu-id="3cde5-149">When you look at security audit events and application event logs, you will see that each JEA user session has a unique virtual account.</span></span>
<span data-ttu-id="3cde5-150">Ciò consente di tenere traccia delle azioni dell'utente in un endpoint JEA all'utente originale che ha eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="3cde5-150">This helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span>
<span data-ttu-id="3cde5-151">I nome degli account virtuali seguono il formato "WinRM Virtual Users\\WinRM\_VA\_*ACCOUNTNUMBER*\_*DOMAIN*\_*sAMAccountName*". Ad esempio, se l'utente "Alice" nel dominio "Contoso" riavvia un servizio in un endpoint JEA, il nome utente associato a eventi di gestione del controllo del servizio sarebbe "WinRM Virtual Users\\WinRM\_VA\_1\_contoso\_alice".</span><span class="sxs-lookup"><span data-stu-id="3cde5-151">Virtual account names follow the format "WinRM Virtual Users\\WinRM\_VA\_*ACCOUNTNUMBER*\_*DOMAIN*\_*sAMAccountName*" For example, if user "Alice" in domain "Contoso" restarts a service in a JEA endpoint, the username associated with any service control manager events would be "WinRM Virtual Users\\WinRM\_VA\_1\_contoso\_alice".</span></span>


<span data-ttu-id="3cde5-152">Gli **account del servizio gestito del gruppo (gMSAs)** sono utili quando un server membro ha bisogno di accedere alle risorse di rete nella sessione JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-152">**Group managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span>
<span data-ttu-id="3cde5-153">Un caso d'uso di esempio è l'endpoint JEA usato per controllare l'accesso a un'API REST ospitata in un altro computer.</span><span class="sxs-lookup"><span data-stu-id="3cde5-153">An example use case for this is a JEA endpoint that is used to control access to a REST API hosted on a different machine.</span></span>
<span data-ttu-id="3cde5-154">È semplice scrivere funzioni che creano le chiamate appropriate nell'API REST, ma per l'autenticazione con l'API è necessaria un'identità di rete.</span><span class="sxs-lookup"><span data-stu-id="3cde5-154">It is easy to write functions to make the desired invocations on the REST API, but in order to authenticate with the API you need a network identity.</span></span>
<span data-ttu-id="3cde5-155">L'uso di un account del servizio gestito del gruppo rende possibile il "secondo hop" mantenendo al contempo controllo sui computer che possono usare l'account.</span><span class="sxs-lookup"><span data-stu-id="3cde5-155">Using a group managed service account makes the "second hop" possible while still having control over which computers can use the account.</span></span>
<span data-ttu-id="3cde5-156">Le autorizzazioni valide dei gMSA sono definite dai gruppi di sicurezza (locale o di dominio) a cui appartiene l'account gMSA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-156">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="3cde5-157">Quando un endpoint JEA è configurato per usare un account gMSA, le azioni di tutti gli utenti JEA verranno registrate come se provenissero dallo stesso account del servizio gestito del gruppo.</span><span class="sxs-lookup"><span data-stu-id="3cde5-157">When a JEA endpoint is configured to use a gMSA account, the actions of all JEA users will appear to come from the same group managed service account.</span></span>
<span data-ttu-id="3cde5-158">L'unico modo possibile per tracciare le azioni per un utente specifico consiste nell'identificare il set di comandi eseguiti in una trascrizione della sessione di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3cde5-158">The only way you can trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="3cde5-159">Le **credenziali pass-through** vengono usate quando non si specifica un account RunAs e si vuole che PowerShell usi le credenziali dell'utente che si connette per eseguire i comandi nel server remoto.</span><span class="sxs-lookup"><span data-stu-id="3cde5-159">**Pass-thru credentials** are used when you do not specify a run as account and want PowerShell to use the connecting user's credential to run commands on the remote server.</span></span>
<span data-ttu-id="3cde5-160">Questa configurazione *non* è consigliata per JEA perché sarebbe necessario concedere all'utente che si connette l'accesso diretto ai gruppi di gestione con privilegi.</span><span class="sxs-lookup"><span data-stu-id="3cde5-160">This configuration is *not* recommended for JEA as it would require you to grant the connecting user direct access to privileged management groups.</span></span>
<span data-ttu-id="3cde5-161">Se l'utente che si connette ha già privilegi di amministratore, è possibile evitare del tutto JEA e gestire il sistema con altri mezzi non vincolati.</span><span class="sxs-lookup"><span data-stu-id="3cde5-161">If the connecting user already has admin privileges, they can avoid JEA altogether and manage the system via other, unconstrained means.</span></span>
<span data-ttu-id="3cde5-162">Per altre informazioni, vedere la sezione seguente su come [JEA non protegge contro gli amministratori](#jea-does-not-protect-against-admins).</span><span class="sxs-lookup"><span data-stu-id="3cde5-162">See the section below on how [JEA does not protect against admins](#jea-does-not-protect-against-admins) for more information.</span></span>

<span data-ttu-id="3cde5-163">Gli **account RunAs standard** consentono di specificare qualsiasi account utente con cui verrà eseguita l'intera sessione di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3cde5-163">**Standard run as accounts** allow you to specify any user account under which the entire PowerShell session will run.</span></span>
<span data-ttu-id="3cde5-164">Questa è una distinzione importante, perché una configurazione sessione impostata per l'uso di un account RunAs (con il parametro `-RunAsCredential`) non è compatibile con JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-164">This is an important distinction, because a session configuration set to use a fixed run as account (with the `-RunAsCredential` parameter) is not JEA-aware.</span></span>
<span data-ttu-id="3cde5-165">Ciò significa che le definizioni di ruolo non funzionano più come previsto e a ogni utente autorizzato ad accedere all'endpoint verrà assegnato lo stesso ruolo.</span><span class="sxs-lookup"><span data-stu-id="3cde5-165">That means that role definitions no longer function as expected, and every user authorized to access the endpoint will be assigned the same role.</span></span>

<span data-ttu-id="3cde5-166">È consigliabile non usare RunAsCredential su un endpoint JEA a causa della difficoltà di tracciare le azioni degli utenti specifici e della mancanza di supporto per eseguire il mapping degli utenti ai ruoli.</span><span class="sxs-lookup"><span data-stu-id="3cde5-166">You should not use a RunAsCredential on a JEA endpoint because of the difficulty in tracing actions back to specific users and the lack of support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="3cde5-167">ACL endpoint di WinRM</span><span class="sxs-lookup"><span data-stu-id="3cde5-167">WinRM Endpoint ACL</span></span>

<span data-ttu-id="3cde5-168">Allo stesso modo degli endpoint regolari di comunicazione remota di PowerShell, ogni endpoint JEA ha un elenco di controllo di accesso (ACL) separato impostato nella configurazione WinRM, che controlla gli utenti che possono eseguire l'autenticazione con l'endpoint JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-168">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) set in the WinRM configuration that controls who can authenticate with the JEA endpoint.</span></span>
<span data-ttu-id="3cde5-169">Se la configurazione non è corretta, gli utenti attendibili potrebbero non essere in grado di accedere all'endpoint JEA e/o gli utenti non attendibili potrebbero ottenere accesso.</span><span class="sxs-lookup"><span data-stu-id="3cde5-169">If improperly configured, trusted users may not be able to access the JEA endpoint and/or untrusted users may gain access.</span></span>
<span data-ttu-id="3cde5-170">L'ACL WinRM non influisce tuttavia sul mapping degli utenti ai ruoli JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-170">The WinRM ACL does not, however, affect the mapping of users to JEA roles.</span></span>
<span data-ttu-id="3cde5-171">Ciò viene controllato dal campo *RoleDefinitions* nel file di configurazione sessione registrato nel sistema.</span><span class="sxs-lookup"><span data-stu-id="3cde5-171">That is controlled by the *RoleDefinitions* field in the session configuration file that was registered on the system.</span></span>

<span data-ttu-id="3cde5-172">Per impostazione predefinita, quando si registra un endpoint JEA usando un file di configurazione sessione e una o più funzionalità di ruolo, l'ACL WinRM verrà configurato per consentire il mapping di tutti gli utenti a uno o più ruoli per accedere all'endpoint.</span><span class="sxs-lookup"><span data-stu-id="3cde5-172">By default, when you register a JEA endpoint using a session configuration file and one or more role capabilities, the WinRM ACL will be configured to allow all users mapping to one or more roles access to the endpoint.</span></span>
<span data-ttu-id="3cde5-173">Ad esempio, una sessione JEA configurata usando i comandi seguenti concederà accesso completo a *CONTOSO\JEA\_Lev1* e *CONTOSO\JEA\_Lev2*.</span><span class="sxs-lookup"><span data-stu-id="3cde5-173">For example, a JEA session configured using the following commands will grant full access to *CONTOSO\JEA\_Lev1* and *CONTOSO\JEA\_Lev2*.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="3cde5-174">È possibile controllare le autorizzazioni utente con il cmdlet [Get-PSSessionConfiguration](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration).</span><span class="sxs-lookup"><span data-stu-id="3cde5-174">You can audit user permissions with the [Get-PSSessionConfiguration](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
PS C:\> Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission

Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="3cde5-175">Per modificare l'accesso degli utenti, eseguire `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` per un prompt interattivo o `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` per aggiornare le autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="3cde5-175">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span>
<span data-ttu-id="3cde5-176">Gli utenti devono avere almeno i diritti di *chiamata* per accedere all'endpoint JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-176">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="3cde5-177">Gli altri utenti che hanno accesso all'endpoint JEA ma non rientrano in nessuno ruolo definito nel file di configurazione sessione, saranno in grado di avviare una sessione JEA, ma avranno accesso solo ai cmdlet predefiniti.</span><span class="sxs-lookup"><span data-stu-id="3cde5-177">If additional users are granted access to the JEA endpoint but do not fall into any of the roles defined in the session configuration file, they will be able to start a JEA session but only have access to the default cmdlets.</span></span>
<span data-ttu-id="3cde5-178">È possibile controllare le autorizzazioni degli utenti in un endpoint JEA eseguendo `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="3cde5-178">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span>
<span data-ttu-id="3cde5-179">Vedere l'articolo [Controllo e creazione di report in JEA](audit-and-report.md) per altre informazioni sul controllo dei comandi ai quali ha accesso un utente in un endpoint JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-179">Check out the [Auditing and Reporting on JEA](audit-and-report.md) article for more information about auditing which commands a user has access to in a JEA endpoint.</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="3cde5-180">Ruoli con privilegi minimi</span><span class="sxs-lookup"><span data-stu-id="3cde5-180">Least privilege roles</span></span>

<span data-ttu-id="3cde5-181">Quando si progettano ruoli JEA, è importante ricordare che l'account virtuale o del servizio gestito del gruppo eseguito alla base ha spesso accesso illimitato per gestire il computer locale.</span><span class="sxs-lookup"><span data-stu-id="3cde5-181">When designing JEA roles, it is important to remember that the virtual or group managed service account running behind the scenes often has unrestricted access to manage the local machine.</span></span>
<span data-ttu-id="3cde5-182">Le funzionalità del ruolo JEA limitano l'uso dell'account riducendo i comandi e le applicazioni che possono essere eseguite usando il contesto autorizzato.</span><span class="sxs-lookup"><span data-stu-id="3cde5-182">JEA role capabilities help restrict what that account can be used for by limiting the commands and applications that can be run using that privileged context.</span></span>
<span data-ttu-id="3cde5-183">I ruoli progettati in modo incorretto possono consentire l'esecuzione di comandi pericolosi che potrebbero portare un utente a oltrepassare i limiti JEA o ottenere accesso a informazioni riservate.</span><span class="sxs-lookup"><span data-stu-id="3cde5-183">Improperly designed roles can allow dangerous commands to run that may allow a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="3cde5-184">Ad esempio, prendere in considerazione la voce relativa alla funzionalità di ruolo seguente:</span><span class="sxs-lookup"><span data-stu-id="3cde5-184">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="3cde5-185">Questa funzionalità di ruolo consente agli utenti di eseguire qualsiasi cmdlet di PowerShell con il termine "Process" dal modulo Microsoft.PowerShell.Management.</span><span class="sxs-lookup"><span data-stu-id="3cde5-185">This role capability allows users to run any PowerShell cmdlet with the noun "Process" from the Microsoft.PowerShell.Management module.</span></span>
<span data-ttu-id="3cde5-186">Gli utenti possono aver bisogno di accedere a specifici cmdlet, ad esempio `Get-Process` per identificare le applicazioni in esecuzione nel sistema e `Stop-Process` per terminare qualsiasi applicazioni bloccata.</span><span class="sxs-lookup"><span data-stu-id="3cde5-186">Users may need to access cmdlets like `Get-Process` to understand what applications are running on the system and `Stop-Process` to kill any hung applications.</span></span>
<span data-ttu-id="3cde5-187">Questa voce consente anche il cmdlet `Start-Process`, che può essere usato per avviare un programma arbitrario con autorizzazioni complete di amministratore.</span><span class="sxs-lookup"><span data-stu-id="3cde5-187">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span>
<span data-ttu-id="3cde5-188">Il programma non deve essere installato localmente nel sistema, per cui un utente malintenzionato potrebbe avviare un programma in una condivisione di file che offre privilegi di amministratore locale all'utente che si connette, eseguire malware e così via.</span><span class="sxs-lookup"><span data-stu-id="3cde5-188">The program doesn't need to be installed locally on the system, so an adversary could simply start a program on a file share that gives the connecting user local admin privileges, runs malware, and more.'</span></span>

<span data-ttu-id="3cde5-189">Di seguito viene illustrata una versione più sicura della stessa funzionalità di ruolo:</span><span class="sxs-lookup"><span data-stu-id="3cde5-189">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="3cde5-190">Evitare l'uso di caratteri jolly nelle funzionalità di ruolo e assicurarsi di [controllare le autorizzazioni utente effettive](audit-and-report.md#check-effective-rights-for-a-specific-user) regolarmente per sapere a quali comandi ha accesso un utente.</span><span class="sxs-lookup"><span data-stu-id="3cde5-190">Avoid using wildcards in role capabilities, and be sure to [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) regularly to understand which commands a user has access to.</span></span>

## <a name="jea-does-not-protect-against-admins"></a><span data-ttu-id="3cde5-191">JEA non offre protezione contro gli amministratori</span><span class="sxs-lookup"><span data-stu-id="3cde5-191">JEA does not protect against admins</span></span>

<span data-ttu-id="3cde5-192">Uno dei principi fondamentali di JEA è che consente a utenti non amministratori di eseguire *alcune* attività di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="3cde5-192">One of the core principles of JEA is that it allows non-admins to perform *some* admin tasks.</span></span>
<span data-ttu-id="3cde5-193">JEA non offre protezione contro gli utenti che hanno già privilegi di amministratore.</span><span class="sxs-lookup"><span data-stu-id="3cde5-193">JEA does not protect against those who already have administrator privileges.</span></span>
<span data-ttu-id="3cde5-194">Gli utenti che appartengono ai gruppi "Domain Admins", "Amministratori locali" o ad altri gruppi con privilegi elevati saranno ancora in grado di aggirare le protezioni JEA accedendo al computer con altri mezzi.</span><span class="sxs-lookup"><span data-stu-id="3cde5-194">Users who belong "domain admins," "local admins," or other highly privileged groups in your environment will still be able to get around JEA's protections by signing into the machine via another means.</span></span>
<span data-ttu-id="3cde5-195">Ad esempio, un utente potrebbe accedere con RDP, usare console MMC remote o connettersi agli endpoint di PowerShell non vincolati.</span><span class="sxs-lookup"><span data-stu-id="3cde5-195">They could, for example, sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span>
<span data-ttu-id="3cde5-196">Gli amministratori locali del sistema possono anche modificare le configurazioni JEA per consentire ad altri utenti di gestire il sistema o modificare una funzionalità di ruolo per estendere l'ambito delle operazioni di ciò che un utente può eseguire nella sessione JEA.</span><span class="sxs-lookup"><span data-stu-id="3cde5-196">Local admins on the system can also modify JEA configurations to allow additional users to manage the system or change a role capability to extend the scope of what a user can do in their JEA session.</span></span>
<span data-ttu-id="3cde5-197">È quindi importante valutare le autorizzazioni estese degli utenti JEA per verificare se ci sono altri modi con cui ottenere accesso privilegiato al sistema.</span><span class="sxs-lookup"><span data-stu-id="3cde5-197">It is therefore important to evaluate your JEA users' extended permissions to see if there are other ways they could gain privileged access to the system.</span></span>

<span data-ttu-id="3cde5-198">Una pratica comune è usare JEA per una regolare manutenzione quotidiana e avere una soluzione di gestione dell'accesso con privilegi "Just in Time" per consentire agli utenti di essere temporaneamente amministratori locali in situazioni di emergenza.</span><span class="sxs-lookup"><span data-stu-id="3cde5-198">A common practice is to use JEA for regular day-to-day maintenance and have a "just in time" privileged access management solution allow users to temporarily become local admins in emergency situations.</span></span>
<span data-ttu-id="3cde5-199">In questo modo gli utenti non saranno amministratori permanenti del sistema, ma possono ottenere tali diritti se e solo quando completano un flusso di lavoro che documenta l'uso di tali autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="3cde5-199">This helps ensure users are not permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>