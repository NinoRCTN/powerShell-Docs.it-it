---
title: Importazione di un modulo di PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 697791b3-2135-4a39-b9d7-8566ed67acf2
caps.latest.revision: 13
ms.openlocfilehash: bb5d036e5658c365a4fafa2cac05c0bba9f87019
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/05/2019
ms.locfileid: "72360700"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="3d1e1-102">Importazione di un modulo di PowerShell</span><span class="sxs-lookup"><span data-stu-id="3d1e1-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="3d1e1-103">Una volta installato un modulo in un sistema, è probabile che si desideri importare il modulo.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-103">Once your have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="3d1e1-104">L'importazione è il processo che carica il modulo nella memoria attiva, in modo che un utente possa accedere al modulo nella sessione di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="3d1e1-105">In PowerShell 2,0 è possibile importare un modulo di PowerShell appena installato con una chiamata al cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) .</span><span class="sxs-lookup"><span data-stu-id="3d1e1-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="3d1e1-106">In PowerShell 3,0 PowerShell è in grado di importare in modo implicito un modulo quando una delle funzioni o dei cmdlet del modulo viene chiamata da un utente.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="3d1e1-107">Si noti che in entrambe le versioni si presuppone che il modulo venga installato in un percorso in cui PowerShell è in grado di trovarlo. per altre informazioni, vedere [installazione di un modulo di PowerShell](./installing-a-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="3d1e1-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span> <span data-ttu-id="3d1e1-108">È possibile utilizzare un manifesto del modulo per limitare le parti del modulo esportate ed è possibile utilizzare i parametri della chiamata `Import-Module` per limitare le parti importate.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="3d1e1-109">Importazione di uno snap-in (PowerShell 1,0)</span><span class="sxs-lookup"><span data-stu-id="3d1e1-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="3d1e1-110">I moduli non esistono in PowerShell 1,0: è necessario registrare e usare gli snap-in. Tuttavia, non è consigliabile usare questa tecnologia a questo punto, perché i moduli sono in genere più facili da installare e importare.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="3d1e1-111">Per ulteriori informazioni, vedere [la pagina relativa alla creazione di uno snap-in di Windows PowerShell](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="3d1e1-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="3d1e1-112">Importazione di un modulo con Import-Module (PowerShell 2,0)</span><span class="sxs-lookup"><span data-stu-id="3d1e1-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="3d1e1-113">PowerShell 2,0 usa il cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) con nome appropriato per importare i moduli.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="3d1e1-114">Quando si esegue questo cmdlet, Windows PowerShell cerca il modulo specificato nelle directory specificate nella variabile `PSModulePath`.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="3d1e1-115">Quando viene trovata la directory specificata, Windows PowerShell cerca i file nell'ordine seguente: file manifesto del modulo (con estensione psd1), file del modulo di script (con estensione psm1), file dei moduli binari (. dll).</span><span class="sxs-lookup"><span data-stu-id="3d1e1-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="3d1e1-116">Per ulteriori informazioni sull'aggiunta di directory alla ricerca, vedere [modifica del percorso di installazione di PSModulePath](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="3d1e1-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span> <span data-ttu-id="3d1e1-117">Il codice seguente descrive come importare un modulo:</span><span class="sxs-lookup"><span data-stu-id="3d1e1-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="3d1e1-118">Supponendo che il modulo sia stato individuato nella `PSModulePath`, PowerShell caricherà il modulo nella memoria attiva.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="3d1e1-119">Se il modulo non si trovava in un percorso di `PSModulePath`, era comunque possibile indicare in modo esplicito a PowerShell dove trovarlo:</span><span class="sxs-lookup"><span data-stu-id="3d1e1-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="3d1e1-120">È anche possibile usare il parametro-Verbose per identificare ciò che viene esportato dal modulo e cosa viene importato nella memoria attiva.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-120">You can also use the -verbose parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="3d1e1-121">Sia le esportazioni che le importazioni limitano gli elementi esposti all'utente: la differenza consiste nel controllare la visibilità.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="3d1e1-122">Essenzialmente, le esportazioni sono controllate dal codice all'interno del modulo.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="3d1e1-123">Al contrario, le importazioni vengono controllate dalla chiamata `Import-Module`.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="3d1e1-124">Per ulteriori informazioni, vedere la sezione relativa alla **restrizione dei membri importati**di seguito.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="3d1e1-125">Importazione implicita di un modulo (PowerShell 3,0)</span><span class="sxs-lookup"><span data-stu-id="3d1e1-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="3d1e1-126">A partire da Windows PowerShell 3.0, i moduli vengono importati automaticamente quando un cmdlet o una funzione nel modulo viene usato in un comando.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="3d1e1-127">Questa funzionalità funziona in qualsiasi modulo di una directory inclusa nel valore della variabile di ambiente **PSModulePath** .</span><span class="sxs-lookup"><span data-stu-id="3d1e1-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="3d1e1-128">Se il modulo non viene salvato in un percorso valido, è comunque possibile caricarli usando l'opzione di [Importazione-modulo](/powershell/module/Microsoft.PowerShell.Core/Import-Module) esplicita descritta in precedenza.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="3d1e1-129">Le azioni seguenti attivano l'importazione automatica di un modulo, noto anche come "caricamento automatico del modulo".</span><span class="sxs-lookup"><span data-stu-id="3d1e1-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="3d1e1-130">Utilizzando un cmdlet in un comando.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="3d1e1-131">Ad esempio, digitando `Get-ExecutionPolicy` viene importato il modulo Microsoft. PowerShell. Security che contiene il cmdlet `Get-ExecutionPolicy`.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="3d1e1-132">Usare il cmdlet [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) per ottenere il comando.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span>  <span data-ttu-id="3d1e1-133">Ad esempio, digitando `Get-Command Get-JobTrigger` viene importato il modulo **PSScheduledJob** che contiene il cmdlet `Get-JobTrigger`.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="3d1e1-134">Un comando `Get-Command` che include caratteri jolly viene considerato l'individuazione e non attiva l'importazione di un modulo.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="3d1e1-135">Usare il cmdlet [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) per ottenere la guida per un cmdlet.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="3d1e1-136">Ad esempio, digitando `Get-Help Get-WinEvent` viene importato il modulo Microsoft. PowerShell. Diagnostics che contiene il cmdlet `Get-WinEvent`.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="3d1e1-137">Per supportare l'importazione automatica dei moduli, il cmdlet `Get-Command` ottiene tutti i cmdlet e le funzioni in tutti i moduli installati, anche se il modulo non viene importato nella sessione.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="3d1e1-138">Per ulteriori informazioni, vedere l'argomento della Guida relativo al cmdlet [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) .</span><span class="sxs-lookup"><span data-stu-id="3d1e1-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="3d1e1-139">Processo di importazione</span><span class="sxs-lookup"><span data-stu-id="3d1e1-139">The Importing Process</span></span>

<span data-ttu-id="3d1e1-140">Quando viene importato un modulo, viene creato un nuovo stato della sessione per il modulo e un oggetto [System. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) viene creato in memoria.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="3d1e1-141">Viene creato uno stato sessione per ogni modulo importato (inclusi il modulo radice e tutti i moduli nidificati).</span><span class="sxs-lookup"><span data-stu-id="3d1e1-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="3d1e1-142">I membri esportati dal modulo radice, inclusi i membri che sono stati esportati nel modulo radice da tutti i moduli annidati, vengono quindi importati nello stato sessione del chiamante.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="3d1e1-143">I metadati dei membri esportati da un modulo hanno una proprietà ModuleName.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="3d1e1-144">Questa proprietà viene popolata con il nome del modulo che ha esportato.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="3d1e1-145">Se il nome di un membro esportato usa un verbo non approvato o se il nome del membro usa caratteri limitati, viene visualizzato un avviso quando viene eseguito il cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) .</span><span class="sxs-lookup"><span data-stu-id="3d1e1-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="3d1e1-146">Per impostazione predefinita, il cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) non restituisce alcun oggetto alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="3d1e1-147">Tuttavia, il cmdlet supporta un `PassThru` parametro che può essere usato per restituire un oggetto [System. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) per ogni modulo importato.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-147">However, the cmdlet supports a `PassThru` parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="3d1e1-148">Per inviare l'output all'host, gli utenti devono eseguire il cmdlet [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) .</span><span class="sxs-lookup"><span data-stu-id="3d1e1-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="3d1e1-149">Limitazione dei membri importati</span><span class="sxs-lookup"><span data-stu-id="3d1e1-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="3d1e1-150">Quando un modulo viene importato usando il cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) , per impostazione predefinita tutti i membri del modulo esportati vengono importati nella sessione, inclusi tutti i comandi esportati nel modulo da un modulo annidato.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="3d1e1-151">Per impostazione predefinita, le variabili e gli alias non vengono esportati.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="3d1e1-152">Per limitare i membri esportati, utilizzare un [manifesto del modulo](./how-to-write-a-powershell-module-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="3d1e1-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span> <span data-ttu-id="3d1e1-153">Per limitare i membri importati, utilizzare i seguenti parametri del cmdlet `Import-Module`.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="3d1e1-154">`Function`: questo parametro limita le funzioni esportate.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-154">`Function`: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="3d1e1-155">Se si usa un manifesto del modulo, vedere la chiave FunctionsToExport.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="3d1e1-156">`Cmdlet`: questo parametro limita i cmdlet esportati (se si usa un manifesto del modulo, vedere la chiave CmdletsToExport).</span><span class="sxs-lookup"><span data-stu-id="3d1e1-156">`Cmdlet`: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="3d1e1-157">`Variable`: questo parametro limita le variabili esportate (se si usa un manifesto del modulo, vedere la chiave VariablesToExport).</span><span class="sxs-lookup"><span data-stu-id="3d1e1-157">`Variable`: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="3d1e1-158">`Alias`: questo parametro limita gli alias esportati. Se si usa un manifesto del modulo, vedere la chiave AliasesToExport.</span><span class="sxs-lookup"><span data-stu-id="3d1e1-158">`Alias`: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="3d1e1-159">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="3d1e1-159">See Also</span></span>

[<span data-ttu-id="3d1e1-160">Scrittura di un modulo di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="3d1e1-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
