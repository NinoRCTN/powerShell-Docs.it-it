---
title: Caricamento ed esportazione dei dati di formattazione | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2a48de31-7961-4b0e-b58b-93466e38370b
caps.latest.revision: 6
ms.openlocfilehash: 5c5168ffd74c15066b914ad1b39d9ead947c5e7f
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/15/2019
ms.locfileid: "72365120"
---
# <a name="loading-and-exporting-formatting-data"></a><span data-ttu-id="bc619-102">Caricamento ed esportazione di dati di formattazione</span><span class="sxs-lookup"><span data-stu-id="bc619-102">Loading and Exporting Formatting Data</span></span>

<span data-ttu-id="bc619-103">Dopo aver creato il file di formattazione, è necessario aggiornare i dati del formato della sessione caricando i file nella sessione corrente.</span><span class="sxs-lookup"><span data-stu-id="bc619-103">Once you have created your formatting file, you need to update the format data of the session by loading your files into the current session.</span></span> <span data-ttu-id="bc619-104">I file di formattazione forniti da Windows PowerShell vengono caricati dagli snap-in che vengono registrati al momento dell'apertura della sessione corrente. Una volta aggiornati i dati del formato della sessione corrente, Windows PowerShell usa tali dati per visualizzare gli oggetti .NET associati alle visualizzazioni definite nei file di formattazione caricati.</span><span class="sxs-lookup"><span data-stu-id="bc619-104">(The formatting files provided by Windows PowerShell are loaded by snap-ins that are registered when the current session is opened.) Once the format data of the current session is updated, Windows PowerShell uses that data to display the .NET objects associated with the views defined in the loaded formatting files.</span></span> <span data-ttu-id="bc619-105">Non esiste alcun limite al numero di file di formattazione che è possibile caricare nella sessione corrente.</span><span class="sxs-lookup"><span data-stu-id="bc619-105">There is no limit to the number of formatting files that you can load into the current session.</span></span> <span data-ttu-id="bc619-106">Oltre ad aggiornare i dati di formattazione, è possibile esportare di nuovo i dati del formato nella sessione corrente in un file di formattazione.</span><span class="sxs-lookup"><span data-stu-id="bc619-106">In addition to updating the formatting data, you can export the format data in the current session back to a formatting file.</span></span>

## <a name="loading-format-data"></a><span data-ttu-id="bc619-107">Caricamento dei dati del formato</span><span class="sxs-lookup"><span data-stu-id="bc619-107">Loading format data</span></span>

<span data-ttu-id="bc619-108">I file di formattazione possono essere caricati nella sessione corrente usando i metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="bc619-108">Formatting files can be loaded into the current session using the following methods:</span></span>

- <span data-ttu-id="bc619-109">È possibile importare il file di formattazione nella sessione corrente dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="bc619-109">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="bc619-110">Usare il cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) come descritto nella procedura seguente.</span><span class="sxs-lookup"><span data-stu-id="bc619-110">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>

- <span data-ttu-id="bc619-111">È possibile creare un manifesto del modulo che fa riferimento al file di formattazione.</span><span class="sxs-lookup"><span data-stu-id="bc619-111">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="bc619-112">I moduli consentono di comprimere i file di formattazione per la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="bc619-112">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="bc619-113">Usare il cmdlet [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) per creare il manifesto e il cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) per caricare il modulo nella sessione corrente.</span><span class="sxs-lookup"><span data-stu-id="bc619-113">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="bc619-114">Per ulteriori informazioni sui moduli, vedere [scrittura di un modulo di Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="bc619-114">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="bc619-115">È possibile creare uno snap-in che fa riferimento al file di formattazione.</span><span class="sxs-lookup"><span data-stu-id="bc619-115">You can create a snap-in that references your formatting file.</span></span> <span data-ttu-id="bc619-116">Usare [System. Management. Automation. PSSnapin. formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) per fare riferimento ai file di formattazione.</span><span class="sxs-lookup"><span data-stu-id="bc619-116">Use the [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) to reference your formatting files.</span></span> <span data-ttu-id="bc619-117">Si consiglia vivamente di utilizzare i moduli per creare pacchetti per i cmdlet e i file di formattazione e di tipi associati per la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="bc619-117">It is strongly encouraged to use modules to package cmdlets, and any associated formatting and types files for distribution.</span></span> <span data-ttu-id="bc619-118">Per ulteriori informazioni sui moduli, vedere [scrittura di un modulo di Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="bc619-118">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="bc619-119">Se si richiamano i comandi a livello di codice, è possibile aggiungere una voce del file di formattazione allo stato della sessione iniziale del spazio in cui vengono eseguiti i comandi.</span><span class="sxs-lookup"><span data-stu-id="bc619-119">If you are invoking commands programmatically, you can add a formatting file entry to the initial session state of the runspace where the commands are run.</span></span> <span data-ttu-id="bc619-120">Per altre informazioni sul tipo .NET usato per aggiungere il file di formattazione, vedere [System. Management. Automation. Runspaces. Sessionstateformatentry? DisplayProperty = classe FullName](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) .</span><span class="sxs-lookup"><span data-stu-id="bc619-120">For more information about .NET type used to add the formatting file, see the [System.Management.Automation.Runspaces.Sessionstateformatentry?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) class.</span></span>

<span data-ttu-id="bc619-121">Quando viene caricato un file di formattazione, questo viene aggiunto a un elenco interno usato da Windows PowerShell per determinare la visualizzazione da usare per la visualizzazione degli oggetti dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="bc619-121">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="bc619-122">È possibile anteporre il file di formattazione all'inizio dell'elenco oppure è possibile aggiungerlo alla fine dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="bc619-122">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="bc619-123">Sapere dove è stato aggiunto il file di formattazione a questo elenco è importante se si sta caricando un file di formattazione che definisce una vista per un oggetto con una vista esistente definita, ad esempio quando si desidera modificare il modo in cui un oggetto restituito da un cmdlet di Windows PowerShell core è  visualizzato.</span><span class="sxs-lookup"><span data-stu-id="bc619-123">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="bc619-124">Se si sta caricando un file di formattazione che definisce l'unica visualizzazione per un oggetto, è possibile usare uno dei metodi descritti in precedenza.</span><span class="sxs-lookup"><span data-stu-id="bc619-124">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="bc619-125">Se si sta caricando un file di formattazione che definisce un'altra visualizzazione per un oggetto, è necessario usare il cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) e anteporre il file all'inizio dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="bc619-125">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>

## <a name="storing-your-formatting-file"></a><span data-ttu-id="bc619-126">Archiviazione del file di formattazione</span><span class="sxs-lookup"><span data-stu-id="bc619-126">Storing Your Formatting File</span></span>

<span data-ttu-id="bc619-127">Non è necessario che i file di formattazione siano archiviati su disco.</span><span class="sxs-lookup"><span data-stu-id="bc619-127">There is no requirement for where your formatting files are stored on disk.</span></span> <span data-ttu-id="bc619-128">Tuttavia, è consigliabile archiviarli nella cartella seguente: `user\documents\windowspowershell\`</span><span class="sxs-lookup"><span data-stu-id="bc619-128">However, it is strongly suggested that you store them in the following folder: `user\documents\windowspowershell\`</span></span>

#### <a name="loading-a-format-file-using-import-formatdata"></a><span data-ttu-id="bc619-129">Caricamento di un file di formato con Import-FormatData</span><span class="sxs-lookup"><span data-stu-id="bc619-129">Loading a format file using Import-FormatData</span></span>

1. <span data-ttu-id="bc619-130">Archiviare il file di formattazione su disco.</span><span class="sxs-lookup"><span data-stu-id="bc619-130">Store your formatting file to disk.</span></span>

2. <span data-ttu-id="bc619-131">Eseguire il cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) usando uno dei comandi seguenti.</span><span class="sxs-lookup"><span data-stu-id="bc619-131">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>

   <span data-ttu-id="bc619-132">Per aggiungere il file di formattazione all'inizio dell'elenco, usare questo comando.</span><span class="sxs-lookup"><span data-stu-id="bc619-132">To add your formatting file to the front of the list use this command.</span></span> <span data-ttu-id="bc619-133">Utilizzare questo comando se si modifica la modalità di visualizzazione di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="bc619-133">Use this command if you are changing how an object is displayed.</span></span>

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   <span data-ttu-id="bc619-134">Per aggiungere il file di formattazione alla fine dell'elenco, usare questo comando.</span><span class="sxs-lookup"><span data-stu-id="bc619-134">To add your formatting file to the end of the list use this command.</span></span>

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   <span data-ttu-id="bc619-135">Una volta aggiunto un file usando il cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) , non è possibile rimuovere il file dall'elenco mentre la sessione è aperta.</span><span class="sxs-lookup"><span data-stu-id="bc619-135">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="bc619-136">Per rimuovere il file di formattazione dall'elenco, è necessario chiudere la sessione.</span><span class="sxs-lookup"><span data-stu-id="bc619-136">You must close the session to remove the formatting file from the list.</span></span>

## <a name="exporting-format-data"></a><span data-ttu-id="bc619-137">Esportazione dei dati del formato</span><span class="sxs-lookup"><span data-stu-id="bc619-137">Exporting format data</span></span>

<span data-ttu-id="bc619-138">Inserire il corpo della sezione qui.</span><span class="sxs-lookup"><span data-stu-id="bc619-138">Insert section body here.</span></span>
