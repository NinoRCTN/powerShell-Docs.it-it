---
title: Aggiunta di risorse a un servizio Web OData di gestione | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e620bf6d-76be-47b0-a7a8-f43418f30c60
caps.latest.revision: 6
ms.openlocfilehash: b81a32b867795ae51c3f5308c2f82c31ed2747fa
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/15/2019
ms.locfileid: "72359820"
---
# <a name="adding-resources-to-a-management-odata-web-service"></a><span data-ttu-id="a826c-102">Aggiunta di risorse a un servizio Web OData di gestione</span><span class="sxs-lookup"><span data-stu-id="a826c-102">Adding Resources to a Management OData Web Service</span></span>

<span data-ttu-id="a826c-103">Questo esempio illustra come aggiungere una risorsa a un servizio Web OData di gestione esistente usando la finestra di progettazione dello schema di gestione OData.</span><span class="sxs-lookup"><span data-stu-id="a826c-103">This example demonstrates how to add a resource to an existing Management OData web service by using the Management OData Schema Designer.</span></span> <span data-ttu-id="a826c-104">Nell'esempio [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) viene creato un servizio Web che espone il processo e le risorse del server.</span><span class="sxs-lookup"><span data-stu-id="a826c-104">The [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample creates a web service that exposes the Process and Server resources.</span></span> <span data-ttu-id="a826c-105">In questo esempio verrà aggiunta una risorsa della macchina virtuale (VM) al servizio Web.</span><span class="sxs-lookup"><span data-stu-id="a826c-105">In this example, you will add a Virtual Machine (VM) resource to the web service.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="a826c-106">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="a826c-106">Prerequisites</span></span>

<span data-ttu-id="a826c-107">In questo argomento si presuppone che sia stato scaricato e installato l'esempio [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) , come descritto in [creazione di un servizio Web di Windows PowerShell](./creating-a-management-odata-web-service.md), e che sia stato scaricato e installato la [finestra di progettazione dello schema di gestione OData](https://marketplace.visualstudio.com/items?itemName=jlisc0.ManagementODataSchemaDesigner).</span><span class="sxs-lookup"><span data-stu-id="a826c-107">This topic assumes that you have downloaded and installed the [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample as described in [Creating a Windows PowerShell Web Service](./creating-a-management-odata-web-service.md), and that you have downloaded and installed the [Management OData Schema Designer](https://marketplace.visualstudio.com/items?itemName=jlisc0.ManagementODataSchemaDesigner).</span></span> <span data-ttu-id="a826c-108">In questo argomento si presuppone inoltre che nel computer in cui si configura l'endpoint OData di gestione sia installato il modulo Hyper-V di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a826c-108">This topic also assumes that you have the Hyper-V Windows PowerShell module installed on the computer where you set up the Management Odata endpoint.</span></span>

## <a name="adding-vm-as-a-resource-to-the-web-service"></a><span data-ttu-id="a826c-109">Aggiunta di una macchina virtuale come risorsa al servizio Web</span><span class="sxs-lookup"><span data-stu-id="a826c-109">Adding VM as a Resource to the Web Service</span></span>

<span data-ttu-id="a826c-110">Il primo passaggio consiste nell'importare lo schema dall'endpoint OData di gestione esistente in progettazione schema.</span><span class="sxs-lookup"><span data-stu-id="a826c-110">The first step is to import the schema from the existing Management OData endpoint into the schema designer.</span></span> <span data-ttu-id="a826c-111">Nella procedura riportata di seguito viene descritto come eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="a826c-111">The following procedure describes how to do that.</span></span>

#### <a name="importing-an-existing-schema-into-the-schema-designer"></a><span data-ttu-id="a826c-112">Importazione di uno schema esistente nella finestra di progettazione dello schema</span><span class="sxs-lookup"><span data-stu-id="a826c-112">Importing an existing schema into the schema designer</span></span>

1. <span data-ttu-id="a826c-113">Aprire la finestra di progettazione dello schema OData di gestione.</span><span class="sxs-lookup"><span data-stu-id="a826c-113">Open the Management OData Schema Designer.</span></span>

2. <span data-ttu-id="a826c-114">Scegliere **file** dal menu **file** . **Nuovo** ; **File**.</span><span class="sxs-lookup"><span data-stu-id="a826c-114">From the **File** menu, select **File** ; **New** ; **File**.</span></span> <span data-ttu-id="a826c-115">Verrà visualizzata la finestra di dialogo **nuovo file** .</span><span class="sxs-lookup"><span data-stu-id="a826c-115">The **New File** dialog appears.</span></span>

3. <span data-ttu-id="a826c-116">Fare clic su **Gestione modello OData**, quindi fare clic su **Apri**.</span><span class="sxs-lookup"><span data-stu-id="a826c-116">Click **Management OData Model**, and then click **Open**.</span></span>

4. <span data-ttu-id="a826c-117">Fare clic con il pulsante destro del mouse nella finestra principale, quindi scegliere **file di schema** . **Importa**.</span><span class="sxs-lookup"><span data-stu-id="a826c-117">Right-click in the main window, and click **Schema file** ; **Import**.</span></span> <span data-ttu-id="a826c-118">Verrà visualizzata la finestra di dialogo **Apri** .</span><span class="sxs-lookup"><span data-stu-id="a826c-118">The **Open** dialog appears.</span></span>

5. <span data-ttu-id="a826c-119">Passare alla cartella in cui è stato configurato il servizio Web di gestione OData per l'esempio [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) .</span><span class="sxs-lookup"><span data-stu-id="a826c-119">Navigate to the folder where you set up the Management OData web service for the [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample.</span></span> <span data-ttu-id="a826c-120">Se è stato usato lo script di Windows PowerShell fornito con tale esempio per configurare l'endpoint senza modificare lo script, la cartella è **C:\inetpub\wwwroot\Modata**.</span><span class="sxs-lookup"><span data-stu-id="a826c-120">If you used the Windows PowerShell script provided with that sample to set up the endpoint without modifying the script, that folder is **C:\inetpub\wwwroot\Modata**.</span></span> <span data-ttu-id="a826c-121">Selezionare Schema. mof, quindi fare clic su **Apri**.</span><span class="sxs-lookup"><span data-stu-id="a826c-121">Select Schema.mof, and click **Open**.</span></span>

   <span data-ttu-id="a826c-122">A questo punto, aprire i file schema. mof e schema. XML in un editor di testo e notare che contengono i mapping per le risorse del processo e del servizio.</span><span class="sxs-lookup"><span data-stu-id="a826c-122">At this point, open the Schema.mof and Schema.xml files in a text editor, and notice that they contain mappings for the Process and Service resources.</span></span> <span data-ttu-id="a826c-123">Il file schema. MOF utilizza lo standard MOF ( [Distributed Management Task Force](https://www.dmtf.org/) ).</span><span class="sxs-lookup"><span data-stu-id="a826c-123">The Schema.mof file uses [Distributed Management  Task Force](https://www.dmtf.org/) (DTMF) Managed Object (MOF) standard.</span></span> <span data-ttu-id="a826c-124">Nel file schema. XML viene utilizzato un XML Schema descritto in [schema di mapping delle risorse](./resource-mapping-schema.md).</span><span class="sxs-lookup"><span data-stu-id="a826c-124">The schema.xml file uses an XML schema that is described in [Resource Mapping Schema](./resource-mapping-schema.md).</span></span>

   <span data-ttu-id="a826c-125">Nella procedura seguente viene descritto come importare i cmdlet di Hyper-V in nel modello di schema.</span><span class="sxs-lookup"><span data-stu-id="a826c-125">The following procedure describes how to import Hyper-V cmdlets in to the schema model.</span></span>

#### <a name="importing-cmdlets-into-the-schema"></a><span data-ttu-id="a826c-126">Importazione di cmdlet nello schema</span><span class="sxs-lookup"><span data-stu-id="a826c-126">Importing cmdlets into the schema</span></span>

1. <span data-ttu-id="a826c-127">Fare clic con il pulsante destro del mouse su un'area vuota della finestra di progettazione schema, quindi scegliere **Importa cmdlet**.</span><span class="sxs-lookup"><span data-stu-id="a826c-127">Right-click on a blank area of the schema designer window, and click **Import Cmdlets**.</span></span> <span data-ttu-id="a826c-128">Verrà visualizzata la finestra di dialogo **importazione guidata cmdlet** .</span><span class="sxs-lookup"><span data-stu-id="a826c-128">The **Cmdlet Import Wizard** dialog appears.</span></span>

2. <span data-ttu-id="a826c-129">Verificare che il **computer locale** sia selezionato e fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="a826c-129">Make sure **Local Computer** is selected, and click **Next**.</span></span>

3. <span data-ttu-id="a826c-130">Assicurarsi che sia selezionata l'opzione moduli di Windows PowerShell installati e selezionare Hyper-V dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="a826c-130">Make sure that Installed Windows PowerShell Modules is selected, and select Hyper-V from the drop-down list.</span></span> <span data-ttu-id="a826c-131">fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="a826c-131">click **Next**.</span></span> <span data-ttu-id="a826c-132">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="a826c-132">Click **Next**.</span></span>

4. <span data-ttu-id="a826c-133">Nell'elenco **nome cmdlet** selezionare **VM**.</span><span class="sxs-lookup"><span data-stu-id="a826c-133">In the **Cmdlet Noun** list, select **VM**.</span></span> <span data-ttu-id="a826c-134">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="a826c-134">Click **Next**</span></span>

5. <span data-ttu-id="a826c-135">Per questo esempio, vengono associati solo i comandi Get ed Delete con i cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a826c-135">For this example, we will bind only the Get and Delete commands with cmdlets.</span></span> <span data-ttu-id="a826c-136">Deselezionare le caselle di controllo **Crea** e **Aggiorna** e verificare che le caselle di controllo **Ottieni** ed **Elimina** siano selezionate.</span><span class="sxs-lookup"><span data-stu-id="a826c-136">Clear the **CREATE** and **UPDATE** checkboxes, and make sure the **GET** and **DELETE** checkboxes are checked.</span></span> <span data-ttu-id="a826c-137">Verificare che sia selezionato il cmdlet `Get-VM` per **Get**e che il cmdlet `Remove-VM` sia selezionato per l' **eliminazione**.</span><span class="sxs-lookup"><span data-stu-id="a826c-137">Make sure that the `Get-VM` cmdlet is selected for **GET**, and the `Remove-VM` cmdlet is selected for **DELETE**.</span></span>

6. <span data-ttu-id="a826c-138">Poiché i metadati per i cmdlet della macchina virtuale non specificano un tipo di output, sarà necessario eseguire il cmdlet per specificare il tipo di output.</span><span class="sxs-lookup"><span data-stu-id="a826c-138">Because the metadata for the VM cmdlets does not specify an output type, you will need to run the cmdlet to specify the output type.</span></span> <span data-ttu-id="a826c-139">Selezionare **Fornisci tipo di output** e fare clic su **Esegui cmdlet**.</span><span class="sxs-lookup"><span data-stu-id="a826c-139">Select **Provide output type** and click **Run cmdlet**.</span></span> <span data-ttu-id="a826c-140">Verrà visualizzata la finestra di dialogo **Esegui cmdlet** .</span><span class="sxs-lookup"><span data-stu-id="a826c-140">The **Run Cmdlet** dialog appears.</span></span> <span data-ttu-id="a826c-141">Fare clic su **Esegui**.</span><span class="sxs-lookup"><span data-stu-id="a826c-141">Click **Run**.</span></span> <span data-ttu-id="a826c-142">La casella **tipo CLR** viene popolata con il tipo `VirtualMachine`.</span><span class="sxs-lookup"><span data-stu-id="a826c-142">The **CLR Type** box is populated with the `VirtualMachine` type.</span></span> <span data-ttu-id="a826c-143">Fare clic su **OK**, quindi su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="a826c-143">Click **OK**, then click **Next**.</span></span>

7. <span data-ttu-id="a826c-144">Per impostazione predefinita, vengono selezionate tutte le proprietà dell'oggetto VirtualMachine.</span><span class="sxs-lookup"><span data-stu-id="a826c-144">By default, all of the properties of the VirtualMachine object are selected.</span></span> <span data-ttu-id="a826c-145">È possibile deselezionare tutte le proprietà che non si desidera includere come parte dei dati restituiti quando si richiede questa risorsa dal servizio Web.</span><span class="sxs-lookup"><span data-stu-id="a826c-145">You can clear any properties that you do not want as part of the data returned when you request this resource from the web service.</span></span> <span data-ttu-id="a826c-146">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="a826c-146">Click **Next**.</span></span>

8. <span data-ttu-id="a826c-147">È necessario selezionare almeno una proprietà da utilizzare come chiave.</span><span class="sxs-lookup"><span data-stu-id="a826c-147">You must select at least one property to be used as a key.</span></span> <span data-ttu-id="a826c-148">Selezionare **nome** nell'elenco e fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="a826c-148">Select **Name** in the list, and click **Next**.</span></span>

9. <span data-ttu-id="a826c-149">La finestra successiva consente di eseguire il mapping delle proprietà della risorsa OData di gestione alle proprietà dei cmdlet sottostanti.</span><span class="sxs-lookup"><span data-stu-id="a826c-149">The next window allows you to map properties of the Management OData resource to properties of the underlying cmdlets.</span></span> <span data-ttu-id="a826c-150">Per impostazione predefinita, la procedura guidata esegue il mapping delle proprietà con nomi identici.</span><span class="sxs-lookup"><span data-stu-id="a826c-150">The wizard maps properties with identical names by default.</span></span> <span data-ttu-id="a826c-151">Ad esempio, la proprietà `ComputerName` della risorsa viene mappata alla proprietà `ComputerName` dei cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a826c-151">For example, the `ComputerName` property of the resource is mapped to the `ComputerName` property of the cmdlets.</span></span>  <span data-ttu-id="a826c-152">In questo modo è possibile specificare la proprietà `ComputerName` in una richiesta al servizio Web e fare in modo che il valore specificato venga passato al cmdlet `Get-VM`.</span><span class="sxs-lookup"><span data-stu-id="a826c-152">This allows you to specify the `ComputerName` property in a request to the web service, and have the value you specify be passed to the `Get-VM` cmdlet.</span></span> <span data-ttu-id="a826c-153">per impostazione predefinita, viene inoltre eseguito il mapping di `Id` e `Name`.</span><span class="sxs-lookup"><span data-stu-id="a826c-153">`Id` and `Name` are also mapped by default.</span></span>

   10. <span data-ttu-id="a826c-154">Fare clic su **Avanti**, quindi su **fine**.</span><span class="sxs-lookup"><span data-stu-id="a826c-154">Click **Next**, then click **Finish**.</span></span>

       <span data-ttu-id="a826c-155">La risorsa VM viene ora visualizzata nella finestra Progettazione schema.</span><span class="sxs-lookup"><span data-stu-id="a826c-155">The VM resource now appears in the schema designer window.</span></span> <span data-ttu-id="a826c-156">È possibile esaminare le proprietà e le operazioni associate alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="a826c-156">You can examine the properties and operations associated with the resource.</span></span> <span data-ttu-id="a826c-157">Successivamente, i file di schema aggiornati vengono esportati nella directory virtuale per il servizio Web.</span><span class="sxs-lookup"><span data-stu-id="a826c-157">Next, you will export the updated schema files into the virtual directory for the web service.</span></span>

#### <a name="exporting-schema-files-from-the-schema-designer"></a><span data-ttu-id="a826c-158">Esportazione di file di schema da progettazione schema</span><span class="sxs-lookup"><span data-stu-id="a826c-158">Exporting schema files from the schema designer</span></span>

1. <span data-ttu-id="a826c-159">Fare clic con il pulsante destro del mouse su un'area vuota della finestra di progettazione schema, quindi scegliere **file di schema** . **Esporta**.</span><span class="sxs-lookup"><span data-stu-id="a826c-159">Right-click on a blank area of the schema designer window, and click **Schema file** ; **Export**.</span></span> <span data-ttu-id="a826c-160">Verrà visualizzata la finestra **di dialogo Salva con nome** .</span><span class="sxs-lookup"><span data-stu-id="a826c-160">The **Save As** dialog appears.</span></span>

2. <span data-ttu-id="a826c-161">Passare alla stessa directory da cui è stato importato il file MOF.</span><span class="sxs-lookup"><span data-stu-id="a826c-161">Navigate to the same directory from where you imported the MOF file.</span></span> <span data-ttu-id="a826c-162">Denominare il file come il file MOF originale (schema. mof per impostazione predefinita) e fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="a826c-162">Name the file the same as the original MOF file (Schema.mof by default), and click **Save**.</span></span> <span data-ttu-id="a826c-163">Confermare che si desidera sovrascrivere il file esistente.</span><span class="sxs-lookup"><span data-stu-id="a826c-163">Confirm that you want to overwrite the existing file.</span></span>

   <span data-ttu-id="a826c-164">Sebbene non sia indicato in modo esplicito nella finestra di dialogo **Salva con nome** , sostituisce i file schema. mof e schema. XML.</span><span class="sxs-lookup"><span data-stu-id="a826c-164">Although it is not explicitly stated in the **Save As** dialog, this replaces both the Schema.mof and Schema.xml files.</span></span>

## <a name="next-steps"></a><span data-ttu-id="a826c-165">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="a826c-165">Next Steps</span></span>

<span data-ttu-id="a826c-166">Prima di accedere alla nuova risorsa VM dal servizio Web di gestione OData, è necessario aggiornare il file RbacConfiguration. XML per consentire l'accesso al modulo di Windows PowerShell Hyper-V, come descritto in [configurazione dell'autorizzazione basata sui ruoli](./configuring-role-based-authorization.md). Inoltre, sarà possibile è necessario riavviare il servizio Web.</span><span class="sxs-lookup"><span data-stu-id="a826c-166">Before you access the new VM resource from the Management OData web service, you must update the RbacConfiguration.xml file to allow access to the Hyper-V Windows PowerShell module as described in [Configuring Role-based Authorization](./configuring-role-based-authorization.md), and you will also need to restart the web service.</span></span>